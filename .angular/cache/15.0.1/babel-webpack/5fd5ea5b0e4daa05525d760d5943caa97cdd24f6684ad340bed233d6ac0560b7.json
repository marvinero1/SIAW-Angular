{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { Validators, FormControl } from '@angular/forms';\nimport { MAT_DATE_LOCALE } from '@angular/material/core';\nimport { map, startWith } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@services/log-service.service\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@services/api.service\";\nimport * as i5 from \"ngx-toastr\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/dialog\";\nimport * as i8 from \"@angular/material/form-field\";\nimport * as i9 from \"@angular/material/core\";\nimport * as i10 from \"@angular/material/autocomplete\";\nimport * as i11 from \"@angular/material/input\";\nimport * as i12 from \"@angular/material/button\";\nfunction UsuarioCreateComponent_mat_option_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var option_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", option_r3.nombre1, \" - \", option_r3.apellido1, \" \");\n  }\n}\nfunction UsuarioCreateComponent_option_63_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var serols_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", serols_r4.codigo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", serols_r4.descripcion, \" \");\n  }\n}\nvar UsuarioCreateComponent = /** @class */function () {\n  function UsuarioCreateComponent(_formBuilder, log_module, _snackBar, api, _locale, toastr, datePipe, dialogRef) {\n    this._formBuilder = _formBuilder;\n    this.log_module = log_module;\n    this._snackBar = _snackBar;\n    this.api = api;\n    this._locale = _locale;\n    this.toastr = toastr;\n    this.datePipe = datePipe;\n    this.dialogRef = dialogRef;\n    this.pepersona = [];\n    this.serol = [];\n    this.dataform = '';\n    this.fecha_actual = new Date();\n    this.hora_actual = new Date();\n    this.loading = false;\n    this.ventana = \"usuario-create\";\n    this.myControl = new FormControl('');\n    this.options = [];\n    this.FormularioData = this.createForm();\n    this.getAllpePersona();\n    this.getAllRol();\n  }\n  UsuarioCreateComponent.prototype.createForm = function () {\n    var usuario_logueado = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\n    var hour = this.hora_actual.getHours();\n    var minuts = this.hora_actual.getMinutes();\n    var hora_actual_complete = hour + \":\" + minuts;\n    return this._formBuilder.group({\n      login: [this.dataform.login, Validators.compose([Validators.required])],\n      password: [this.dataform.password, Validators.compose([Validators.required])],\n      persona: [1],\n      vencimiento: [this.datePipe.transform(this.dataform.vencimiento, \"yyyy-MM-dd\")],\n      activo: [this.dataform.activo],\n      codrol: [this.dataform.codrol],\n      fechareg: [this.datePipe.transform(this.fecha_actual, \"yyyy-MM-dd\")],\n      correo: [this.dataform.correo],\n      password_siaw: [this.dataform.password_siaw],\n      fechareg_siaw: [this.datePipe.transform(this.fecha_actual, \"yyyy-MM-dd\")],\n      horareg: [hora_actual_complete],\n      usuarioreg: [usuario_logueado]\n    });\n  };\n  UsuarioCreateComponent.prototype.ngOnInit = function () {\n    var _this = this;\n    this.filteredOptions = this.myControl.valueChanges.pipe(startWith(''), map(function (value) {\n      var name = typeof value === 'string' ? value : value === null || value === void 0 ? void 0 : value.nombre1;\n      return name ? _this._filter(name) : _this.options.slice();\n    }));\n  };\n  UsuarioCreateComponent.prototype._filter = function (name) {\n    var filterValue = name.toLowerCase();\n    return this.pepersona.filter(function (option) {\n      return option.nombre1.toLowerCase().includes(filterValue);\n    });\n  };\n  UsuarioCreateComponent.prototype.getAllpePersona = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n        this.errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\n        return [2 /*return*/, this.api.getAll('/pers_plan/mant/pepersona/' + this.userConn).subscribe({\n          next: function (datav) {\n            _this.pepersona = datav;\n            // console.log('data', datav);\n          },\n\n          error: function (err) {\n            console.log(err, _this.errorMessage);\n          },\n          complete: function () {}\n        })];\n      });\n    });\n  };\n  UsuarioCreateComponent.prototype.displayFn = function (pePersona) {\n    return pePersona && pePersona.nombre1 ? pePersona.nombre1 : '';\n  };\n  UsuarioCreateComponent.prototype.getAllRol = function () {\n    var _this = this;\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    this.errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\n    return this.api.getAll('/seg_adm/mant/serol/' + this.userConn).subscribe({\n      next: function (datav) {\n        _this.serol = datav;\n      },\n      error: function (err) {\n        console.log(err, _this.errorMessage);\n      },\n      complete: function () {}\n    });\n  };\n  UsuarioCreateComponent.prototype.submitData = function () {\n    var _this = this;\n    this.userConn = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\n    var data = this.FormularioData.value;\n    console.log(data);\n    this.errorMessage = \"La Ruta o el servidor presenta fallos al hacer la creacion\" + \"Ruta:--  /seg_adm/mant/adusuario\";\n    return this.api.create(\"/seg_adm/mant/adusuario/\" + this.userConn, data).subscribe({\n      next: function (datav) {\n        _this.serol = datav;\n        _this.log_module.guardarLog(_this.ventana, _this.detalle, _this.tipo);\n        console.log('data', datav);\n        _this.toastr.error('! GUARDADO !');\n        _this._snackBar.open('Se ha guardado correctamente!', 'Ok', {\n          duration: 3000\n        });\n        location.reload();\n      },\n      error: function (err) {\n        console.log(err, _this.errorMessage);\n        _this.toastr.error('! NO SE GUARDO !');\n      },\n      complete: function () {}\n    });\n  };\n  UsuarioCreateComponent.prototype.onNoClick = function () {\n    this.dialogRef.close();\n  };\n  UsuarioCreateComponent.ɵfac = function UsuarioCreateComponent_Factory(t) {\n    return new (t || UsuarioCreateComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.LogService), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.ApiService), i0.ɵɵdirectiveInject(MAT_DATE_LOCALE), i0.ɵɵdirectiveInject(i5.ToastrService), i0.ɵɵdirectiveInject(i6.DatePipe), i0.ɵɵdirectiveInject(i7.MatDialogRef));\n  };\n  UsuarioCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UsuarioCreateComponent,\n    selectors: [[\"app-usuario-create\"]],\n    decls: 71,\n    vars: 9,\n    consts: [[1, \"p-2\"], [\"mat-dialog-title\", \"\"], [2, \"font-size\", \"0.6rem\", \"padding\", \"0 24px 0px\"], [\"mat-dialog-content\", \"\"], [1, \"example-form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"row\"], [1, \"col-md\"], [2, \"padding-right\", \"70px\"], [\"matInput\", \"\", \"type\", \"text\", \"formControlName\", \"login\", \"required\", \"\"], [2, \"padding-right\", \"45px\"], [\"type\", \"password\", \"matInput\", \"\", \"formControlName\", \"password\", \"maxlength\", \"10\", \"required\", \"\"], [2, \"padding-right\", \"35px\"], [\"matInput\", \"\", \"type\", \"email\", \"formControlName\", \"correo\", \"required\", \"\"], [\"type\", \"password\", \"matInput\", \"\", \"formControlName\", \"password_siaw\", \"maxlength\", \"10\", \"required\", \"\"], [1, \"col\"], [2, \"padding-right\", \"66px\"], [\"type\", \"text\", \"matInput\", \"\", 3, \"formControl\", \"matAutocomplete\", \"ngModel\"], [3, \"displayWith\"], [\"auto\", \"matAutocomplete\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [2, \"padding-right\", \"40px\"], [\"type\", \"date\", \"formControlName\", \"vencimiento\", \"required\", \"\"], [2, \"padding-right\", \"80px\"], [\"formControlName\", \"activo\"], [\"value\", \"true\"], [\"value\", \"false\"], [2, \"padding-right\", \"83px\"], [\"formControlName\", \"codrol\"], [\"mat-dialog-actions\", \"\", 1, \"mat-dialog-actions\"], [\"mat-button\", \"\", 3, \"click\"], [1, \"fa\", \"fa-arrow-left\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 3, \"disabled\"], [1, \"fa\", \"fa-save\"], [3, \"value\"]],\n    template: function UsuarioCreateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1);\n        i0.ɵɵtext(2, \"Crear Usuario\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵtext(4, \"Los campos (*) son obligatorios\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"form\", 4);\n        i0.ɵɵlistener(\"ngSubmit\", function UsuarioCreateComponent_Template_form_ngSubmit_6_listener() {\n          return ctx.submitData();\n        });\n        i0.ɵɵelementStart(7, \"div\", 5)(8, \"div\", 6)(9, \"mat-label\", 7)(10, \"u\");\n        i0.ɵɵtext(11, \"Usuario\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(12, \"input\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"div\", 5)(14, \"div\", 6)(15, \"mat-label\", 9)(16, \"u\");\n        i0.ɵɵtext(17, \"Contrase\\u00F1a\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(18, \"input\", 10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"div\", 5)(20, \"div\", 6)(21, \"mat-label\", 11)(22, \"u\");\n        i0.ɵɵtext(23, \"Correo SIAW\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(24, \"input\", 12);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(25, \"div\", 5)(26, \"div\", 6)(27, \"mat-label\")(28, \"u\");\n        i0.ɵɵtext(29, \"Contrase\\u00F1a SIAW \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(30, \"input\", 13);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(31, \"div\", 5)(32, \"div\", 14)(33, \"mat-label\", 15)(34, \"u\");\n        i0.ɵɵtext(35, \"Persona\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"input\", 16);\n        i0.ɵɵlistener(\"ngModel\", function UsuarioCreateComponent_Template_input_ngModel_36_listener() {\n          return ctx.pepersona_get;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"mat-autocomplete\", 17, 18);\n        i0.ɵɵtemplate(39, UsuarioCreateComponent_mat_option_39_Template, 2, 3, \"mat-option\", 19);\n        i0.ɵɵpipe(40, \"async\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(41, \"div\", 5)(42, \"div\", 14)(43, \"mat-label\", 20)(44, \"u\");\n        i0.ɵɵtext(45, \"Vencimiento\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(46, \"input\", 21);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(47, \"div\", 5)(48, \"div\", 14)(49, \"mat-label\", 22)(50, \"u\");\n        i0.ɵɵtext(51, \"Activo\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(52, \"select\", 23)(53, \"option\", 24);\n        i0.ɵɵtext(54, \"SI\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"option\", 25);\n        i0.ɵɵtext(56, \"NO\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(57, \"div\", 5)(58, \"div\", 14)(59, \"mat-label\", 26)(60, \"u\");\n        i0.ɵɵtext(61, \"Roles\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(62, \"select\", 27);\n        i0.ɵɵtemplate(63, UsuarioCreateComponent_option_63_Template, 2, 2, \"option\", 19);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(64, \"div\", 28)(65, \"button\", 29);\n        i0.ɵɵlistener(\"click\", function UsuarioCreateComponent_Template_button_click_65_listener() {\n          return ctx.onNoClick();\n        });\n        i0.ɵɵelement(66, \"i\", 30);\n        i0.ɵɵtext(67, \" Atras\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(68, \"button\", 31);\n        i0.ɵɵelement(69, \"i\", 32);\n        i0.ɵɵtext(70, \" Guardar\");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        var _r0 = i0.ɵɵreference(38);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"formGroup\", ctx.FormularioData);\n        i0.ɵɵadvance(30);\n        i0.ɵɵproperty(\"formControl\", ctx.myControl)(\"matAutocomplete\", _r0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"displayWith\", ctx.displayFn);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(40, 7, ctx.filteredOptions));\n        i0.ɵɵadvance(24);\n        i0.ɵɵproperty(\"ngForOf\", ctx.serol);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"disabled\", !ctx.FormularioData.valid);\n      }\n    },\n    dependencies: [i6.NgForOf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.MaxLengthValidator, i1.FormControlDirective, i1.FormGroupDirective, i1.FormControlName, i8.MatLabel, i9.MatOption, i10.MatAutocomplete, i10.MatAutocompleteTrigger, i11.MatInput, i7.MatDialogTitle, i7.MatDialogContent, i7.MatDialogActions, i12.MatButton, i6.AsyncPipe],\n    styles: [\".mat-mdc-form-field[_ngcontent-%COMP%] {\\n  width: inherit !important;\\n}\\n\\n.mat-dialog-actions[_ngcontent-%COMP%] {\\n  float: right;\\n}\\n/*# sourceURL=webpack://./src/app/components/mantenimiento/usuario/usuario-create/usuario-create.component.scss */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9tYW50ZW5pbWllbnRvL3VzdWFyaW8vdXN1YXJpby1jcmVhdGUvdXN1YXJpby1jcmVhdGUuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSx5QkFBQTtBQUNKOztBQUVBO0VBQ0ksWUFBQTtBQUNKIiwic291cmNlc0NvbnRlbnQiOlsiLm1hdC1tZGMtZm9ybS1maWVsZCB7XG4gIHdpZHRoOiBpbmhlcml0ICFpbXBvcnRhbnQ7XG59XG5cbi5tYXQtZGlhbG9nLWFjdGlvbnMge1xuICBmbG9hdDogcmlnaHQ7XG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n  return UsuarioCreateComponent;\n}();\nexport { UsuarioCreateComponent };","map":{"version":3,"mappings":";AACA,SAAoBA,UAAU,EAAeC,WAAW,QAAQ,gBAAgB;AAKhF,SAASC,eAAe,QAAQ,wBAAwB;AAExD,SAAqBC,GAAG,EAAEC,SAAS,QAAQ,MAAM;;;;;;;;;;;;;;;;ICgCvCC,sCAA4E;IAC1EA,YACF;IAAAA,iBAAa;;;;IAF8CA,iCAAgB;IACzEA,eACF;IADEA,8EACF;;;;;IA0BAA,kCAA6D;IAC3DA,YACF;IAAAA,iBAAS;;;;IAF4BA,wCAAuB;IAC1DA,eACF;IADEA,sDACF;;;AD1DV;EA4BE,gCAAoBC,YAAyB,EAASC,UAAqB,EAAQC,SAAsB,EAAUC,GAAc,EAC9FC,OAAe,EAAUC,MAAqB,EACvEC,QAAkB,EAASC,SAA+C;IAFhE,iBAAY,GAAZP,YAAY;IAAsB,eAAU,GAAVC,UAAU;IAAmB,cAAS,GAATC,SAAS;IAAuB,QAAG,GAAHC,GAAG;IACnF,YAAO,GAAPC,OAAO;IAAkB,WAAM,GAANC,MAAM;IACxD,aAAQ,GAARC,QAAQ;IAAmB,cAAS,GAATC,SAAS;IAtBvC,cAAS,GAAO,EAAE;IAClB,UAAK,GAAO,EAAE;IACd,aAAQ,GAAK,EAAE;IACf,iBAAY,GAAG,IAAIC,IAAI,EAAE;IACzB,gBAAW,GAAG,IAAIA,IAAI,EAAE;IACxB,YAAO,GAAY,KAAK;IAExB,YAAO,GAAC,gBAAgB;IAO/B,cAAS,GAAG,IAAIb,WAAW,CAAqB,EAAE,CAAC;IACnD,YAAO,GAAgB,EAAE;IASvB,IAAI,CAACc,cAAc,GAAG,IAAI,CAACC,UAAU,EAAE;IACvC,IAAI,CAACC,eAAe,EAAE;IACtB,IAAI,CAACC,SAAS,EAAE;EAClB;EAEAC,2CAAU,GAAV;IACC,IAAIC,gBAAgB,GAAGC,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC,KAAKC,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC,CAAC,GAAG,IAAI;IAE1I,IAAII,IAAI,GAAG,IAAI,CAACC,WAAW,CAACC,QAAQ,EAAE;IACtC,IAAIC,MAAM,GAAG,IAAI,CAACF,WAAW,CAACG,UAAU,EAAE;IAC1C,IAAIC,oBAAoB,GAAGL,IAAI,GAAG,GAAG,GAAGG,MAAM;IAE9C,OAAO,IAAI,CAACvB,YAAY,CAAC0B,KAAK,CAAC;MAC7BC,KAAK,EAAE,CAAC,IAAI,CAACC,QAAQ,CAACD,KAAK,EAACjC,UAAU,CAACmC,OAAO,CAAC,CAACnC,UAAU,CAACoC,QAAQ,CAAC,CAAC,CAAC;MACtEC,QAAQ,EAAE,CAAC,IAAI,CAACH,QAAQ,CAACG,QAAQ,EAACrC,UAAU,CAACmC,OAAO,CAAC,CAACnC,UAAU,CAACoC,QAAQ,CAAC,CAAC,CAAC;MAC5EE,OAAO,EAAE,CAAC,CAAC,CAAC;MACZC,WAAW,EAAE,CAAC,IAAI,CAAC3B,QAAQ,CAAC4B,SAAS,CAAC,IAAI,CAACN,QAAQ,CAACK,WAAW,EAAE,YAAY,CAAC,CAAC;MAC/EE,MAAM,EAAE,CAAC,IAAI,CAACP,QAAQ,CAACO,MAAM,CAAC;MAC9BC,MAAM,EAAE,CAAC,IAAI,CAACR,QAAQ,CAACQ,MAAM,CAAC;MAC9BC,QAAQ,EAAE,CAAC,IAAI,CAAC/B,QAAQ,CAAC4B,SAAS,CAAC,IAAI,CAACI,YAAY,EAAC,YAAY,CAAC,CAAC;MACnEC,MAAM,EAAE,CAAC,IAAI,CAACX,QAAQ,CAACW,MAAM,CAAC;MAC9BC,aAAa,EAAE,CAAC,IAAI,CAACZ,QAAQ,CAACY,aAAa,CAAC;MAC5CC,aAAa,EAAE,CAAC,IAAI,CAACnC,QAAQ,CAAC4B,SAAS,CAAC,IAAI,CAACI,YAAY,EAAC,YAAY,CAAC,CAAC;MACxEI,OAAO,EAAE,CAACjB,oBAAoB,CAAC;MAC/BkB,UAAU,EAAE,CAAC7B,gBAAgB;KAC9B,CAAC;EACJ,CAAC;EAEDD,yCAAQ,GAAR;IAAA;IACG,IAAI,CAAC+B,eAAe,GAAG,IAAI,CAACC,SAAS,CAACC,YAAY,CAACC,IAAI,CACtDjD,SAAS,CAAC,EAAE,CAAC,EACbD,GAAG,CAAC,eAAK;MACP,IAAMmD,IAAI,GAAG,OAAOC,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAGA,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEC,OAAO;MAC/D,OAAOF,IAAI,GAAGG,KAAI,CAACC,OAAO,CAACJ,IAAc,CAAC,GAAGG,KAAI,CAACE,OAAO,CAACC,KAAK,EAAE;IACnE,CAAC,CAAC,CACH;EACH,CAAC;EAEOzC,wCAAO,GAAf,UAAgBmC,IAAY;IAC1B,IAAMO,WAAW,GAAGP,IAAI,CAACQ,WAAW,EAAE;IAEtC,OAAO,IAAI,CAACC,SAAS,CAACC,MAAM,CAAC,gBAAM;MAAI,aAAM,CAACR,OAAO,CAACM,WAAW,EAAE,CAACG,QAAQ,CAACJ,WAAW,CAAC;IAAlD,CAAkD,CAAC;EAC5F,CAAC;EAEK1C,gDAAe,GAArB;;;;QACE,IAAI,CAAC+C,QAAQ,GAAG7C,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,KAAKC,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,GAAG,IAAI;QAEtH,IAAI,CAAC6C,YAAY,GAAG,6DAA6D;QACjF,sBAAO,IAAI,CAAC1D,GAAG,CAAC2D,MAAM,CAAC,4BAA4B,GAAC,IAAI,CAACF,QAAQ,CAAC,CAC/DG,SAAS,CAAC;UACTC,IAAI,EAAE,UAACC,KAAK;YACVd,KAAI,CAACM,SAAS,GAAGQ,KAAK;YACtB;UACF,CAAC;;UACDC,KAAK,EAAE,UAACC,GAAQ;YACdC,OAAO,CAACC,GAAG,CAACF,GAAG,EAAEhB,KAAI,CAACU,YAAY,CAAC;UACrC,CAAC;UACDS,QAAQ,EAAE,aAAQ;SACrB,CAAC;;;GACH;EAEDzD,0CAAS,GAAT,UAAU0D,SAAoB;IAC5B,OAAOA,SAAS,IAAIA,SAAS,CAACrB,OAAO,GAAGqB,SAAS,CAACrB,OAAO,GAAG,EAAE;EAChE,CAAC;EAEDrC,0CAAS,GAAT;IAAA;IACE,IAAI,CAAC+C,QAAQ,GAAG7C,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,KAAKC,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,GAAG,IAAI;IAEtH,IAAI,CAAC6C,YAAY,GAAG,6DAA6D;IACjF,OAAO,IAAI,CAAC1D,GAAG,CAAC2D,MAAM,CAAC,sBAAsB,GAAE,IAAI,CAACF,QAAQ,CAAC,CAC1DG,SAAS,CAAC;MACTC,IAAI,EAAE,UAACC,KAAK;QACVd,KAAI,CAACqB,KAAK,GAAGP,KAAK;MACpB,CAAC;MAEDC,KAAK,EAAE,UAACC,GAAQ;QACdC,OAAO,CAACC,GAAG,CAACF,GAAG,EAAEhB,KAAI,CAACU,YAAY,CAAC;MACrC,CAAC;MACDS,QAAQ,EAAE,aAAQ;KACnB,CAAC;EACN,CAAC;EAEDzD,2CAAU,GAAV;IAAA;IACE,IAAI,CAAC+C,QAAQ,GAAG7C,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC,KAAKC,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAC,CAAC,GAAG,IAAI;IACpI,IAAIyD,IAAI,GAAG,IAAI,CAAChE,cAAc,CAACwC,KAAK;IACpCmB,OAAO,CAACC,GAAG,CAACI,IAAI,CAAC;IAEjB,IAAI,CAACZ,YAAY,GAAG,4DAA4D,GAAC,kCAAkC;IACnH,OAAO,IAAI,CAAC1D,GAAG,CAACuE,MAAM,CAAC,0BAA0B,GAAC,IAAI,CAACd,QAAQ,EAAEa,IAAI,CAAC,CACnEV,SAAS,CAAC;MACTC,IAAI,EAAE,UAACC,KAAK;QACVd,KAAI,CAACqB,KAAK,GAAGP,KAAK;QAClBd,KAAI,CAAClD,UAAU,CAAC0E,UAAU,CAACxB,KAAI,CAACyB,OAAO,EAACzB,KAAI,CAAC0B,OAAO,EAAE1B,KAAI,CAAC2B,IAAI,CAAC;QAChEV,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEJ,KAAK,CAAC;QAC1Bd,KAAI,CAAC9C,MAAM,CAAC6D,KAAK,CAAC,cAAc,CAAC;QACjCf,KAAI,CAACjD,SAAS,CAAC6E,IAAI,CAAC,+BAA+B,EAAE,IAAI,EAAE;UACzDC,QAAQ,EAAE;SACX,CAAC;QAEFC,QAAQ,CAACC,MAAM,EAAE;MACnB,CAAC;MAEDhB,KAAK,EAAE,UAACC,GAAQ;QACdC,OAAO,CAACC,GAAG,CAACF,GAAG,EAAEhB,KAAI,CAACU,YAAY,CAAC;QACnCV,KAAI,CAAC9C,MAAM,CAAC6D,KAAK,CAAC,kBAAkB,CAAC;MACvC,CAAC;MACDI,QAAQ,EAAE,aAAQ;KACnB,CAAC;EACN,CAAC;EAEDzD,0CAAS,GAAT;IACE,IAAI,CAACN,SAAS,CAAC4E,KAAK,EAAE;EACxB,CAAC;;qBA1IUtE,sBAAsB,6KAuBvBjB,eAAe;EAAA;;UAvBdiB,sBAAsB;IAAAuE;IAAAC;IAAAC;IAAAC;IAAAC;MAAA;QClBnCzF,8BAAiB;QACMA,6BAAa;QAAAA,iBAAK;QACvCA,8BAAoD;QAAAA,+CAA+B;QAAAA,iBAAM;QAG3FA,8BAAwB;QACkCA;UAAA,OAAY0F,gBAAY;QAAA,EAAC;QAC/E1F,8BAAiB;QAE8BA,wBAAO;QAAAA,iBAAI;QACtDA,4BAA6D;QAC/DA,iBAAM;QAGRA,+BAAiB;QAE8BA,gCAAU;QAAAA,iBAAI;QACzDA,6BAAmF;QACrFA,iBAAM;QAGRA,+BAAiB;QAE8BA,4BAAW;QAAAA,iBAAI;QAC1DA,6BAA+D;QACjEA,iBAAM;QAGRA,+BAAiB;QAECA,sCAAgB;QAAAA,iBAAI;QAClCA,6BAAwF;QAC1FA,iBAAM;QAGRA,+BAAiB;QAE8BA,wBAAO;QAAAA,iBAAI;QACtDA,kCAAyG;QAA1BA;UAAA;QAAA,EAAyB;QAAxGA,iBAAyG;QACzGA,iDAAoE;QAClEA,wFAEa;;QACfA,iBAAmB;QAIvBA,+BAAiB;QAE8BA,4BAAW;QAAAA,iBAAI;QAC1DA,6BAA0D;QAC5DA,iBAAM;QAGRA,+BAAiB;QAE8BA,uBAAM;QAAAA,iBAAI;QACrDA,mCAAiC;QACZA,mBAAE;QAAAA,iBAAS;QAC9BA,mCAAoB;QAAAA,mBAAE;QAAAA,iBAAS;QAKrCA,+BAAiB;QAE8BA,sBAAK;QAAAA,iBAAI;QACpDA,mCAAiC;QAC/BA,gFAES;QACXA,iBAAS;QAIbA,gCAAmD;QAC9BA;UAAA,OAAS0F,eAAW;QAAA,EAAC;QAAC1F,yBAAgC;QAACA,uBAAK;QAAAA,iBAAS;QACxFA,mCAA2F;QAAAA,yBAChE;QAACA,yBAAO;QAAAA,iBAAS;;;;QAxErBA,eAA4B;QAA5BA,8CAA4B;QAgCrBA,gBAAyB;QAAzBA,2CAAyB;QACXA,eAAyB;QAAzBA,2CAAyB;QAClCA,eAA0B;QAA1BA,oEAA0B;QA4B9BA,gBAAQ;QAARA,mCAAQ;QASGA,eAAkC;QAAlCA,oDAAkC;;;;;;+BD7ElF;CA6JC,EAjJD;SAMac,sBAAsB","names":["Validators","FormControl","MAT_DATE_LOCALE","map","startWith","i0","_formBuilder","log_module","_snackBar","api","_locale","toastr","datePipe","dialogRef","Date","FormularioData","createForm","getAllpePersona","getAllRol","UsuarioCreateComponent","usuario_logueado","localStorage","getItem","undefined","JSON","parse","hour","hora_actual","getHours","minuts","getMinutes","hora_actual_complete","group","login","dataform","compose","required","password","persona","vencimiento","transform","activo","codrol","fechareg","fecha_actual","correo","password_siaw","fechareg_siaw","horareg","usuarioreg","filteredOptions","myControl","valueChanges","pipe","name","value","nombre1","_this","_filter","options","slice","filterValue","toLowerCase","pepersona","filter","includes","userConn","errorMessage","getAll","subscribe","next","datav","error","err","console","log","complete","pePersona","serol","data","create","guardarLog","ventana","detalle","tipo","open","duration","location","reload","close","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\laragon\\www\\SIAW-Angular-B\\src\\app\\components\\mantenimiento\\usuario\\usuario-create\\usuario-create.component.ts","C:\\laragon\\www\\SIAW-Angular-B\\src\\app\\components\\mantenimiento\\usuario\\usuario-create\\usuario-create.component.html"],"sourcesContent":["import { Component, Inject } from '@angular/core';\r\nimport { FormGroup, Validators, FormBuilder, FormControl } from '@angular/forms';\r\nimport { pePersona } from '@services/modelos/objetos';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ApiService } from '@services/api.service';\r\nimport { DatePipe  } from '@angular/common' \r\nimport { MAT_DATE_LOCALE } from '@angular/material/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { Observable, map, startWith } from 'rxjs';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { LogService } from '@services/log-service.service';\r\n\r\n@Component({\r\n  selector: 'app-usuario-create',\r\n  templateUrl: './usuario-create.component.html',\r\n  styleUrls: ['./usuario-create.component.scss'],\r\n})\r\n\r\nexport class UsuarioCreateComponent {\r\n  \r\n  public pepersona:any = [];\r\n  public serol:any = [];\r\n  public dataform:any='';\r\n  public fecha_actual = new Date(); \r\n  public hora_actual = new Date();\r\n  public loading: boolean = false;\r\n  public errorMessage;\r\n  public ventana=\"usuario-create\"\r\n  public detalle;\r\n  public tipo;\r\n  public pepersona_get;\r\n\r\n  userConn:any;\r\n\r\n  myControl = new FormControl<string | pePersona>('');\r\n  options: pePersona[] = [];\r\n  filteredOptions: Observable<pePersona[]>;\r\n\r\n  FormularioData:FormGroup;\r\n\r\n  constructor(private _formBuilder: FormBuilder, public log_module:LogService,public _snackBar: MatSnackBar, private api:ApiService, \r\n    @Inject(MAT_DATE_LOCALE) private _locale: string, private toastr: ToastrService,\r\n    private datePipe: DatePipe, public dialogRef: MatDialogRef<UsuarioCreateComponent>){\r\n\r\n    this.FormularioData = this.createForm();\r\n    this.getAllpePersona();\r\n    this.getAllRol();\r\n  }\r\n  \r\n  createForm(): FormGroup {\r\n   let usuario_logueado = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\r\n\r\n    let hour = this.hora_actual.getHours();\r\n    let minuts = this.hora_actual.getMinutes();\r\n    let hora_actual_complete = hour + \":\" + minuts;  \r\n\r\n    return this._formBuilder.group({\r\n      login: [this.dataform.login,Validators.compose([Validators.required])],\r\n      password: [this.dataform.password,Validators.compose([Validators.required])],\r\n      persona: [1],\r\n      vencimiento: [this.datePipe.transform(this.dataform.vencimiento, \"yyyy-MM-dd\")],\r\n      activo: [this.dataform.activo],\r\n      codrol: [this.dataform.codrol],\r\n      fechareg: [this.datePipe.transform(this.fecha_actual,\"yyyy-MM-dd\")],\r\n      correo: [this.dataform.correo],\r\n      password_siaw: [this.dataform.password_siaw],\r\n      fechareg_siaw: [this.datePipe.transform(this.fecha_actual,\"yyyy-MM-dd\")],\r\n      horareg: [hora_actual_complete],\r\n      usuarioreg: [usuario_logueado],\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n     this.filteredOptions = this.myControl.valueChanges.pipe(\r\n      startWith(''),\r\n      map(value => {\r\n        const name = typeof value === 'string' ? value : value?.nombre1;\r\n        return name ? this._filter(name as string) : this.options.slice();\r\n      }),\r\n    );\r\n  }\r\n\r\n  private _filter(name: string): pePersona[] {\r\n    const filterValue = name.toLowerCase();\r\n\r\n    return this.pepersona.filter(option => option.nombre1.toLowerCase().includes(filterValue));\r\n  }\r\n\r\n  async getAllpePersona(){\r\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n\r\n    this.errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\r\n    return this.api.getAll('/pers_plan/mant/pepersona/'+this.userConn)\r\n      .subscribe({\r\n        next: (datav) => {\r\n          this.pepersona = datav;\r\n          // console.log('data', datav);\r\n        },\r\n        error: (err: any) => { \r\n          console.log(err, this.errorMessage);\r\n        },\r\n        complete: () => { }\r\n    })\r\n  }\r\n\r\n  displayFn(pePersona: pePersona): string {\r\n    return pePersona && pePersona.nombre1 ? pePersona.nombre1 : '';\r\n  }\r\n\r\n  getAllRol(){\r\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n\r\n    this.errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\r\n    return this.api.getAll('/seg_adm/mant/serol/'+ this.userConn)\r\n      .subscribe({\r\n        next: (datav) => {\r\n          this.serol = datav;\r\n        },\r\n    \r\n        error: (err: any) => { \r\n          console.log(err, this.errorMessage);\r\n        },\r\n        complete: () => { }\r\n      })\r\n  }\r\n\r\n  submitData(){\r\n    this.userConn = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\r\n    let data = this.FormularioData.value;\r\n    console.log(data);\r\n    \r\n    this.errorMessage = \"La Ruta o el servidor presenta fallos al hacer la creacion\"+\"Ruta:--  /seg_adm/mant/adusuario\";\r\n    return this.api.create(\"/seg_adm/mant/adusuario/\"+this.userConn, data)\r\n      .subscribe({\r\n        next: (datav) => {\r\n          this.serol = datav;\r\n          this.log_module.guardarLog(this.ventana,this.detalle, this.tipo);\r\n          console.log('data', datav);  \r\n          this.toastr.error('! GUARDADO !');\r\n          this._snackBar.open('Se ha guardado correctamente!', 'Ok', {\r\n            duration: 3000,\r\n          });\r\n\r\n          location.reload();\r\n        },\r\n    \r\n        error: (err: any) => { \r\n          console.log(err, this.errorMessage);\r\n          this.toastr.error('! NO SE GUARDO !');\r\n        },\r\n        complete: () => { }\r\n      })\r\n  }\r\n\r\n  onNoClick(): void {\r\n    this.dialogRef.close();\r\n  }\r\n}\r\n","<div class=\"p-2\">\r\n  <h1 mat-dialog-title>Crear Usuario</h1>\r\n  <div style=\"font-size: 0.6rem;padding: 0 24px 0px;\">Los campos (*) son obligatorios</div>\r\n</div>\r\n\r\n<div mat-dialog-content>\r\n  <form class=\"example-form\" [formGroup]=\"FormularioData\" (ngSubmit)=\"submitData()\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md\">\r\n        <mat-label style=\"padding-right: 70px;\"><u>Usuario</u></mat-label>\r\n        <input matInput type=\"text\" formControlName=\"login\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-md\">\r\n        <mat-label style=\"padding-right: 45px;\"><u>Contraseña</u></mat-label>\r\n        <input type=\"password\" matInput formControlName=\"password\" maxlength=\"10\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-md\">\r\n        <mat-label style=\"padding-right: 35px;\"><u>Correo SIAW</u></mat-label>\r\n        <input matInput type=\"email\" formControlName=\"correo\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-md\">\r\n        <mat-label><u>Contraseña SIAW </u></mat-label>\r\n        <input type=\"password\" matInput formControlName=\"password_siaw\" maxlength=\"10\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col\">\r\n        <mat-label style=\"padding-right: 66px;\"><u>Persona</u> </mat-label>\r\n        <input type=\"text\" matInput [formControl]=\"myControl\" [matAutocomplete]=\"auto\" (ngModel)=\"pepersona_get\">\r\n        <mat-autocomplete #auto=\"matAutocomplete\" [displayWith]=\"displayFn\">\r\n          <mat-option *ngFor=\"let option of filteredOptions | async\" [value]=\"option\">\r\n            {{option.nombre1}} - {{ option.apellido1 }}\r\n          </mat-option>\r\n        </mat-autocomplete>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col\">\r\n        <mat-label style=\"padding-right: 40px;\"><u>Vencimiento</u> </mat-label>\r\n        <input type=\"date\" formControlName=\"vencimiento\" required>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col\">\r\n        <mat-label style=\"padding-right: 80px;\"><u>Activo</u> </mat-label>\r\n        <select formControlName=\"activo\">\r\n          <option value=true>SI</option>\r\n          <option value=false>NO</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col\">\r\n        <mat-label style=\"padding-right: 83px;\"><u>Roles</u></mat-label>\r\n        <select formControlName=\"codrol\">\r\n          <option *ngFor=\"let serols of serol\" [value]=\"serols.codigo\">\r\n            {{ serols.descripcion }}\r\n          </option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"mat-dialog-actions\" mat-dialog-actions>\r\n      <button mat-button (click)=\"onNoClick()\"><i class=\"fa fa-arrow-left\"></i> Atras</button>\r\n      <button mat-raised-button color=\"primary\" [disabled]=\"!FormularioData.valid\" type=\"submit\"><i\r\n          class=\"fa fa-save\"></i> Guardar</button>\r\n    </div>\r\n  </form>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}