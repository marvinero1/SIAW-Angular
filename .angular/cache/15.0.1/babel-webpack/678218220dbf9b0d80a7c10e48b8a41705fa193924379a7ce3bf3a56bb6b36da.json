{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Tab = void 0;\nconst tslib_1 = require(\"tslib\");\nconst helper_1 = require(\"../utils/helper\");\nclass Tab {\n  constructor() {\n    this.features = ['toolbar=yes', 'scrollbars=yes', 'location=yes', 'resizable=yes', 'top=200', 'width=600', 'height=600'];\n    this.target = '_blank';\n  }\n  open(src) {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      return new Promise((res, rej) => {\n        this.features.push(`left=${(window.innerWidth - 600) / 2}`);\n        this.window = window.open(src, this.target, this.features.toString());\n        this.initializeInterval(res, rej);\n      });\n    });\n  }\n  close() {\n    if (this.responseInterval) {\n      clearInterval(this.responseInterval);\n    }\n    if (this.window) {\n      this.window.close();\n    }\n  }\n  initializeInterval(res, rej) {\n    this.responseInterval = setInterval(this.getChildWindowStringQueries.bind(this, res, rej), 100);\n  }\n  checkIsWindowAccessable(rej) {\n    try {\n      if (this.window.location.href === 'about:blank') {\n        return false;\n      }\n      if (!this.window.location.href) {\n        return rej(new Error('Window closed'));\n      }\n      return !!this.window.location.host;\n    } catch (error) {\n      return false;\n    }\n  }\n  getChildWindowStringQueries(res, rej) {\n    if (!this.checkIsWindowAccessable(rej)) {\n      return;\n    }\n    let params;\n    try {\n      const urlSearchParams = new URLSearchParams(this.window.location.search);\n      params = Object.fromEntries(urlSearchParams.entries());\n    } catch (error) {\n      if (error instanceof DOMException) {\n        return;\n      }\n      this.close();\n      return rej((0, helper_1.handleAuthenticationError)(error));\n    }\n    console.log('params', params);\n    this.close();\n    if (!params || !params.status) {\n      return rej(new Error('Window closed'));\n    }\n    if (params && params.status === 'true') {\n      return res(params);\n    }\n    return rej((0, helper_1.handleAuthenticationError)(params.errorCode));\n  }\n}\nexports.Tab = Tab;","map":{"version":3,"names":["Object","defineProperty","exports","value","Tab","tslib_1","require","helper_1","constructor","features","target","open","src","__awaiter","Promise","res","rej","push","window","innerWidth","toString","initializeInterval","close","responseInterval","clearInterval","setInterval","getChildWindowStringQueries","bind","checkIsWindowAccessable","location","href","Error","host","error","params","urlSearchParams","URLSearchParams","search","fromEntries","entries","DOMException","handleAuthenticationError","console","log","status","errorCode"],"sources":["C:/laragon/www/SIAW-Angular-B/node_modules/gatekeeper-client-sdk/src/core/tab.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Tab = void 0;\nconst tslib_1 = require(\"tslib\");\nconst helper_1 = require(\"../utils/helper\");\nclass Tab {\n    constructor() {\n        this.features = [\n            'toolbar=yes',\n            'scrollbars=yes',\n            'location=yes',\n            'resizable=yes',\n            'top=200',\n            'width=600',\n            'height=600',\n        ];\n        this.target = '_blank';\n    }\n    open(src) {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            return new Promise((res, rej) => {\n                this.features.push(`left=${(window.innerWidth - 600) / 2}`);\n                this.window = window.open(src, this.target, this.features.toString());\n                this.initializeInterval(res, rej);\n            });\n        });\n    }\n    close() {\n        if (this.responseInterval) {\n            clearInterval(this.responseInterval);\n        }\n        if (this.window) {\n            this.window.close();\n        }\n    }\n    initializeInterval(res, rej) {\n        this.responseInterval = setInterval(this.getChildWindowStringQueries.bind(this, res, rej), 100);\n    }\n    checkIsWindowAccessable(rej) {\n        try {\n            if (this.window.location.href === 'about:blank') {\n                return false;\n            }\n            if (!this.window.location.href) {\n                return rej(new Error('Window closed'));\n            }\n            return !!this.window.location.host;\n        }\n        catch (error) {\n            return false;\n        }\n    }\n    getChildWindowStringQueries(res, rej) {\n        if (!this.checkIsWindowAccessable(rej)) {\n            return;\n        }\n        let params;\n        try {\n            const urlSearchParams = new URLSearchParams(this.window.location.search);\n            params = Object.fromEntries(urlSearchParams.entries());\n        }\n        catch (error) {\n            if (error instanceof DOMException) {\n                return;\n            }\n            this.close();\n            return rej((0, helper_1.handleAuthenticationError)(error));\n        }\n        console.log('params', params);\n        this.close();\n        if (!params || !params.status) {\n            return rej(new Error('Window closed'));\n        }\n        if (params && params.status === 'true') {\n            return res(params);\n        }\n        return rej((0, helper_1.handleAuthenticationError)(params.errorCode));\n    }\n}\nexports.Tab = Tab;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}