{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { ValidarPrecioItemComponent } from './validar-precio-item/validar-precio-item.component';\nimport { ValidarPermisoItemComponent } from './validar-permiso-item/validar-permiso-item.component';\nimport { PermisoEspecialPasswordComponent } from '@components/seguridad/permiso-especial-password/permiso-especial-password.component';\nimport { ModalPrecioVentaComponent } from '@components/mantenimiento/ventas/modal-precio-venta/modal-precio-venta.component';\nimport { ModalItemsComponent } from '@components/mantenimiento/ventas/modal-items/modal-items.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@services/api.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"ngx-spinner\";\nimport * as i4 from \"ngx-toastr\";\nimport * as i5 from \"@services/log-service.service\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@components/mantenimiento/ventas/serviciosItem/item-service.service\";\nimport * as i8 from \"@components/mantenimiento/ventas/servicioprecioventa/servicioprecioventa.service\";\nimport * as i9 from \"@modules/main/footer/servicio-nombre-ventana/nombre-ventana.service\";\nimport * as i10 from \"@angular/material/form-field\";\nimport * as i11 from \"@angular/material/button\";\nimport * as i12 from \"@angular/material/card\";\nimport * as i13 from \"@angular/material/tooltip\";\nimport * as i14 from \"@angular/common\";\nvar _c0 = [\"paginator\"];\nvar _c1 = [\"paginatorPageSize\"];\nvar PrecioItemComponent = /** @class */function () {\n  function PrecioItemComponent(api, dialog, spinner, toastr, log_module, _formBuilder, itemservice, servicioPrecioVenta, nombre_ventana_service) {\n    this.api = api;\n    this.dialog = dialog;\n    this.spinner = spinner;\n    this.toastr = toastr;\n    this.log_module = log_module;\n    this._formBuilder = _formBuilder;\n    this.itemservice = itemservice;\n    this.servicioPrecioVenta = servicioPrecioVenta;\n    this.nombre_ventana_service = nombre_ventana_service;\n    this.fecha_actual = new Date();\n    this.hora_actual = new Date();\n    this.dataform = '';\n    this.tarifa_save = [];\n    this.tarifa_get = [];\n    this.codigo_item_catalogo = [];\n    this.cod_precio_venta_modal = [];\n    this.codigo_item_catalogo_get = [];\n    this.precio_actual = [];\n    this.item = [];\n    this.data = [];\n    this.displayedColumns = ['codigo', 'descripcion', 'descripcorta', 'descripabr', 'medida', 'unidad', 'accion'];\n    this.dataSource = new MatTableDataSource();\n    this.dataSourceWithPageSize = new MatTableDataSource();\n    this.nombre_ventana = \"prgindefinir_precioitem.vb\";\n    this.ventana = \"Definir Precio Item\";\n    this.detalle = \"PrecioItem-UPDATE\";\n    this.tipo = \"PrecioItem-UPDATE\";\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    this.usuarioLogueado = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\n    this.FormularioData = this.createForm();\n    this.mandarNombre();\n    this.api.getRolUserParaVentana(this.usuarioLogueado, this.nombre_ventana);\n  }\n  PrecioItemComponent.prototype.ngOnInit = function () {\n    var _this = this;\n    this.getAllitem();\n    this.getTarifa();\n    this.servicioPrecioVenta.disparadorDePrecioVenta.subscribe(function (data) {\n      console.log(\"Recibiendo Precio Venta: \", data);\n      _this.cod_precio_venta_modal = data.precio_venta;\n    });\n    this.itemservice.disparadorDeItems.subscribe(function (data) {\n      console.log(\"Recibiendo Item: \", data);\n      _this.codigo_item_catalogo = data.item;\n    });\n  };\n  PrecioItemComponent.prototype.getAllitem = function () {\n    var _this = this;\n    var user_conn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    var errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\n    return this.api.getAll('/inventario/mant/initem/catalogo/' + user_conn).subscribe({\n      next: function (datav) {\n        _this.item = datav;\n        // console.log(this.item);\n      },\n\n      error: function (err) {\n        console.log(err, errorMessage);\n      },\n      complete: function () {}\n    });\n  };\n  PrecioItemComponent.prototype.onLeaveItem = function (event) {\n    var inputValue = event.target.value;\n    // Verificar si el valor ingresado está presente en los objetos del array\n    var encontrado = this.item.some(function (objeto) {\n      return objeto.codigo === inputValue;\n    });\n    if (!encontrado) {\n      // Si el valor no está en el array, dejar el campo vacío\n      event.target.value = '';\n      console.log(\"NO ENCONTRADO INPUT\");\n    } else {\n      event.target.value = inputValue;\n    }\n    // Puedes realizar otras acciones según tus necesidades\n    console.log('Input perdió el foco', inputValue);\n  };\n  PrecioItemComponent.prototype.getTarifa = function () {\n    var _this = this;\n    var errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\n    return this.api.getAll('/inventario/mant/intarifa/catalogo/' + this.userConn + \"/\" + this.usuarioLogueado).subscribe({\n      next: function (datav) {\n        _this.tarifa_get = datav;\n        // console.log(this.tarifa_get);\n      },\n\n      error: function (err) {\n        console.log(err, errorMessage);\n      },\n      complete: function () {}\n    });\n  };\n  PrecioItemComponent.prototype.onLeaveTarifa = function (event) {\n    var inputValue = event.target.value;\n    var num = Number(inputValue);\n    // Verificar si el valor ingresado está presente en los objetos del array\n    var encontrado = this.tarifa_get.some(function (objeto) {\n      return objeto.codigo === num;\n    });\n    if (!encontrado) {\n      // Si el valor no está en el array, dejar el campo vacío\n      event.target.value = '';\n      console.log(\"NO ENCONTRADO INPUT\");\n    } else {\n      event.target.value = num;\n    }\n    // Puedes realizar otras acciones según tus necesidades\n    console.log('Input perdió el foco', num);\n  };\n  PrecioItemComponent.prototype.getPrecio = function () {\n    var _this = this;\n    var data = this.FormularioData.value;\n    var errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\n    var item_form = data.item;\n    var codtarifa_form = data.codtarifa;\n    if (item_form !== undefined && codtarifa_form !== undefined) {\n      return this.api.getAll('/inventario/oper/prgindefinir_precioitem/getTarifaItem/' + this.userConn + \"/\" + this.codigo_item_catalogo.codigo + \"/\" + this.cod_precio_venta_modal.codigo).subscribe({\n        next: function (datav) {\n          _this.precio_actual = datav;\n          console.log(_this.precio_actual);\n          _this.spinner.show();\n          setTimeout(function () {\n            _this.spinner.hide();\n          }, 1000);\n        },\n        error: function (err) {\n          console.log(err, errorMessage);\n        },\n        complete: function () {}\n      });\n    } else {\n      this.toastr.warning('INGRESE TODOS LOS CAMPOS');\n    }\n  };\n  PrecioItemComponent.prototype.createForm = function () {\n    return this._formBuilder.group({\n      codtarifa: [this.dataform.codtarifa, Validators.compose([Validators.required])],\n      item: [this.dataform.item, Validators.compose([Validators.required])],\n      precio: [this.dataform.precio, Validators.compose([Validators.required])]\n    });\n  };\n  PrecioItemComponent.prototype.validarPrecioConfirmacion = function () {\n    var _this = this;\n    var data = this.FormularioData.value;\n    var dialogRef = this.dialog.open(ValidarPrecioItemComponent, {\n      width: 'auto',\n      height: 'auto',\n      data: {\n        dataItem: data\n      }\n    });\n    dialogRef.afterClosed().subscribe(function (result) {\n      if (result) {\n        console.log(\"Validar Confirmado\");\n        if (result) {\n          _this.validarPrecioItemPassword(data);\n        } else {\n          _this.toastr.error('! NO SE CONFIRMADO !');\n        }\n      } else {\n        _this.toastr.error('! CANCELADO !');\n      }\n    });\n  };\n  PrecioItemComponent.prototype.validarPrecioItemPassword = function (data) {\n    var _this = this;\n    var dialogRef = this.dialog.open(ValidarPermisoItemComponent, {\n      width: 'auto',\n      height: 'auto',\n      data: {\n        data: data\n      }\n    });\n    dialogRef.afterClosed().subscribe(function (result) {\n      if (result) {\n        _this.modalPassword(data);\n      } else {\n        _this.toastr.error('! CANCELADO !');\n      }\n    });\n  };\n  PrecioItemComponent.prototype.modalPassword = function (data) {\n    var _this = this;\n    var precio = this.precio_actual.precio;\n    console.log(precio);\n    var dialogRefModalPasswordConfirm = this.dialog.open(PermisoEspecialPasswordComponent, {\n      width: 'auto',\n      height: 'auto',\n      data: {\n        dataA: precio,\n        dataB: data.precio,\n        permiso_id: \"106\",\n        permiso_text: \"CAMBIAR PRECIO DE ITEM\" //esto es fijo siempre\n      }\n    });\n\n    dialogRefModalPasswordConfirm.afterClosed().subscribe(function (result) {\n      console.log(result);\n      if (result) {\n        _this.submitData();\n      } else {\n        _this.toastr.error('! CANCELADO NO SE GUARDO !');\n      }\n    });\n  };\n  PrecioItemComponent.prototype.submitData = function () {\n    var _this = this;\n    var data = this.FormularioData.value;\n    console.log(data);\n    var errorMessage = \"La Ruta presenta fallos al hacer la creacion\" + \"Ruta:- /inventario/oper/prgindefinir_precioitem/updateTarifa1/\";\n    return this.api.update(\"/inventario/oper/prgindefinir_precioitem/updateTarifa1/\" + this.userConn, data).subscribe({\n      next: function (datav) {\n        if (data) {\n          _this.tarifa_save = datav;\n          _this.getPrecio();\n          _this.log_module.guardarLog(_this.ventana, _this.detalle, _this.tipo);\n          _this.toastr.success('Guardado con Exito! 🎉');\n        } else {\n          _this.toastr.error('! ERROR AL GUARDAR !');\n        }\n      },\n      error: function (err) {\n        console.log(err, errorMessage);\n        _this.toastr.error('! NO SE GUARDO !');\n      },\n      complete: function () {}\n    });\n  };\n  PrecioItemComponent.prototype.modalPrecioTipo = function () {\n    this.dialog.open(ModalPrecioVentaComponent, {\n      width: 'auto',\n      height: 'auto'\n    });\n  };\n  PrecioItemComponent.prototype.modalItem = function () {\n    this.dialog.open(ModalItemsComponent, {\n      width: 'auto',\n      height: 'auto'\n    });\n  };\n  PrecioItemComponent.prototype.mandarNombre = function () {\n    this.nombre_ventana_service.disparadorDeNombreVentana.emit({\n      nombre_vent: this.ventana\n    });\n  };\n  PrecioItemComponent.ɵfac = function PrecioItemComponent_Factory(t) {\n    return new (t || PrecioItemComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.NgxSpinnerService), i0.ɵɵdirectiveInject(i4.ToastrService), i0.ɵɵdirectiveInject(i5.LogService), i0.ɵɵdirectiveInject(i6.FormBuilder), i0.ɵɵdirectiveInject(i7.ItemServiceService), i0.ɵɵdirectiveInject(i8.ServicioprecioventaService), i0.ɵɵdirectiveInject(i9.NombreVentanaService));\n  };\n  PrecioItemComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PrecioItemComponent,\n    selectors: [[\"app-precio-item\"]],\n    viewQuery: function PrecioItemComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        var _t = void 0;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginatorPageSize = _t.first);\n      }\n    },\n    decls: 67,\n    vars: 13,\n    consts: [[1, \"p-2\"], [1, \"overlay\"], [\"bdColor\", \"rgba(251, 216, 0, 0.8)\", \"size\", \"large\", \"color\", \"#093070\", \"type\", \"square-loader\", 3, \"fullScreen\"], [2, \"font-size\", \"25px\", \"color\", \"rgb(9,48,112,)\"], [1, \"row\"], [1, \"col-lg\"], [2, \"background-color\", \"#f0f0f0\"], [1, \"mb-1\"], [2, \"font-size\", \"0.8rem\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"tg-0lax\"], [1, \"input-group\"], [2, \"padding-right\", \"47px\", \"padding-top\", \"3px\"], [\"type\", \"text\", \"formControlName\", \"item\", 2, \"width\", \"59% !important\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [1, \"input-group-append\"], [\"type\", \"button\", \"matTooltip\", \"Buscar Item\", 1, \"btn\", \"btn-outline-primary\", 2, \"border-color\", \"#093070\", \"padding\", \"4px 5px 1px 5px\", \"line-height\", \"0 !important\", 3, \"click\"], [1, \"fa\", \"fa-search\"], [2, \"padding-right\", \"8px\", \"padding-top\", \"3px\"], [\"type\", \"text\", \"formControlName\", \"codtarifa\", 2, \"width\", \"59% !important\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [\"type\", \"button\", \"matTooltip\", \"Precios\", 1, \"btn\", \"btn-outline-primary\", 2, \"border-color\", \"#093070\", \"padding\", \"4px 5px 1px 5px\", \"line-height\", \"0 !important\", 3, \"click\"], [2, \"padding-right\", \"2px\"], [2, \"padding-right\", \"0px\", \"padding-top\", \"7px\"], [\"type\", \"number\", \"formControlName\", \"precio\", \"min\", \"0\", 2, \"width\", \"70% !important\", 3, \"step\"], [\"align\", \"start\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 3, \"disabled\"], [1, \"fa\", \"fa-cog\"], [\"mat-raised-button\", \"\", \"color\", \"secondary\", 3, \"click\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-retweet\"]],\n    template: function PrecioItemComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"ngx-spinner\", 2);\n        i0.ɵɵelement(3, \"br\");\n        i0.ɵɵelementStart(4, \"p\", 3);\n        i0.ɵɵtext(5, \"\\uD83D\\uDD29 Cargando... \\uD83D\\uDD29\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"div\", 0)(9, \"mat-card\", 6)(10, \"mat-card-header\", 7)(11, \"mat-card-title\", 8)(12, \"strong\");\n        i0.ɵɵtext(13, \" Definir Precio Item\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(14, \"mat-card-content\")(15, \"div\", 4)(16, \"form\", 9);\n        i0.ɵɵlistener(\"ngSubmit\", function PrecioItemComponent_Template_form_ngSubmit_16_listener() {\n          return ctx.validarPrecioConfirmacion();\n        });\n        i0.ɵɵelementStart(17, \"tr\")(18, \"th\", 10)(19, \"div\", 11)(20, \"mat-label\", 12)(21, \"u\");\n        i0.ɵɵtext(22, \"Item\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(23, \"input\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function PrecioItemComponent_Template_input_ngModelChange_23_listener($event) {\n          return ctx.codigo_item_catalogo.codigo = $event;\n        })(\"blur\", function PrecioItemComponent_Template_input_blur_23_listener($event) {\n          return ctx.onLeaveItem($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 14)(25, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function PrecioItemComponent_Template_button_click_25_listener() {\n          return ctx.modalItem();\n        });\n        i0.ɵɵelement(26, \"i\", 16);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(27, \"th\", 10)(28, \"div\");\n        i0.ɵɵtext(29);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(30, \"tr\")(31, \"th\", 10)(32, \"div\", 11)(33, \"mat-label\", 17)(34, \"u\");\n        i0.ɵɵtext(35, \"Precio Tipo\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"input\", 18);\n        i0.ɵɵlistener(\"ngModelChange\", function PrecioItemComponent_Template_input_ngModelChange_36_listener($event) {\n          return ctx.cod_precio_venta_modal.codigo = $event;\n        })(\"blur\", function PrecioItemComponent_Template_input_blur_36_listener($event) {\n          return ctx.onLeaveTarifa($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"div\", 14)(38, \"button\", 19);\n        i0.ɵɵlistener(\"click\", function PrecioItemComponent_Template_button_click_38_listener() {\n          return ctx.modalPrecioTipo();\n        });\n        i0.ɵɵelement(39, \"i\", 16);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(40, \"th\", 10)(41, \"div\");\n        i0.ɵɵtext(42);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(43, \"tr\")(44, \"td\", 10)(45, \"mat-label\", 20)(46, \"u\");\n        i0.ɵɵtext(47, \"Precio Actual\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtext(48);\n        i0.ɵɵpipe(49, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"td\", 10);\n        i0.ɵɵtext(51);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(52, \"hr\");\n        i0.ɵɵelementStart(53, \"tr\")(54, \"td\", 10)(55, \"mat-label\", 21)(56, \"u\");\n        i0.ɵɵtext(57, \"Precio Nuevo\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(58, \"input\", 22);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(59, \"mat-card-actions\", 23)(60, \"button\", 24);\n        i0.ɵɵelement(61, \"i\", 25);\n        i0.ɵɵtext(62, \" \\u00A0Cambiar \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtext(63, \"\\u00A0 \");\n        i0.ɵɵelementStart(64, \"button\", 26);\n        i0.ɵɵlistener(\"click\", function PrecioItemComponent_Template_button_click_64_listener() {\n          return ctx.getPrecio();\n        });\n        i0.ɵɵelement(65, \"i\", 27);\n        i0.ɵɵtext(66, \"\\u00A0Refrescar \");\n        i0.ɵɵelementEnd()()()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"fullScreen\", true);\n        i0.ɵɵadvance(14);\n        i0.ɵɵproperty(\"formGroup\", ctx.FormularioData);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.codigo_item_catalogo.codigo);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\" \", ctx.codigo_item_catalogo.descripcion, \" \");\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.cod_precio_venta_modal.codigo);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.cod_precio_venta_modal.descripcion);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(49, 10, ctx.precio_actual.precio, \"1.5-5\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" \", ctx.precio_actual.monedaBase, \" \");\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"step\", 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !ctx.FormularioData.valid);\n      }\n    },\n    dependencies: [i6.ɵNgNoValidate, i6.DefaultValueAccessor, i6.NumberValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.MinValidator, i6.FormGroupDirective, i6.FormControlName, i10.MatLabel, i11.MatButton, i3.NgxSpinnerComponent, i12.MatCard, i12.MatCardActions, i12.MatCardContent, i12.MatCardHeader, i12.MatCardTitle, i13.MatTooltip, i14.DecimalPipe],\n    styles: [\".mat-mdc-header-row[_ngcontent-%COMP%] {\\n  background: #093070;\\n}\\n\\ntd[_ngcontent-%COMP%] {\\n  text-align: left;\\n}\\n\\nth[_ngcontent-%COMP%], mat-sort-header[_ngcontent-%COMP%] {\\n  text-align: center !important;\\n}\\n\\n.mat-mdc-table[_ngcontent-%COMP%]   .mdc-data-table__header-row[_ngcontent-%COMP%] {\\n  height: calc(1.6rem + 0px) !important;\\n}\\n\\n.mat-mdc-table[_ngcontent-%COMP%]   .mdc-data-table__row[_ngcontent-%COMP%] {\\n  height: calc(0rem + 0px) !important;\\n}\\n\\nspan[_ngcontent-%COMP%] {\\n  color: #093070 !important;\\n}\\n/*# sourceURL=webpack://./src/app/components/inventario/operaciones/precio-item/precio-item.component.scss */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9pbnZlbnRhcmlvL29wZXJhY2lvbmVzL3ByZWNpby1pdGVtL3ByZWNpby1pdGVtLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksbUJBQUE7QUFDSjs7QUFDQTtFQUNJLGdCQUFBO0FBRUo7O0FBQUE7RUFDSSw2QkFBQTtBQUdKOztBQURBO0VBQ0kscUNBQUE7QUFJSjs7QUFGQTtFQUNJLG1DQUFBO0FBS0o7O0FBSEE7RUFDSSx5QkFBQTtBQU1KIiwic291cmNlc0NvbnRlbnQiOlsiLm1hdC1tZGMtaGVhZGVyLXJvdyB7XG4gIGJhY2tncm91bmQ6ICMwOTMwNzA7XG59XG5cbnRkIHtcbiAgdGV4dC1hbGlnbjogbGVmdDtcbn1cblxudGgsIG1hdC1zb3J0LWhlYWRlciB7XG4gIHRleHQtYWxpZ246IGNlbnRlciAhaW1wb3J0YW50O1xufVxuXG4ubWF0LW1kYy10YWJsZSAubWRjLWRhdGEtdGFibGVfX2hlYWRlci1yb3cge1xuICBoZWlnaHQ6IGNhbGMoMS42cmVtICsgMHB4KSAhaW1wb3J0YW50O1xufVxuXG4ubWF0LW1kYy10YWJsZSAubWRjLWRhdGEtdGFibGVfX3JvdyB7XG4gIGhlaWdodDogY2FsYygwcmVtICsgMHB4KSAhaW1wb3J0YW50O1xufVxuXG5zcGFuIHtcbiAgY29sb3I6ICMwOTMwNzAgIWltcG9ydGFudDtcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n  return PrecioItemComponent;\n}();\nexport { PrecioItemComponent };","map":{"version":3,"mappings":"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","names":["Validators","MatTableDataSource","ValidarPrecioItemComponent","ValidarPermisoItemComponent","PermisoEspecialPasswordComponent","ModalPrecioVentaComponent","ModalItemsComponent","api","dialog","spinner","toastr","log_module","_formBuilder","itemservice","servicioPrecioVenta","nombre_ventana_service","Date","userConn","localStorage","getItem","undefined","JSON","parse","usuarioLogueado","FormularioData","createForm","mandarNombre","getRolUserParaVentana","nombre_ventana","PrecioItemComponent","getAllitem","getTarifa","disparadorDePrecioVenta","subscribe","console","log","data","_this","cod_precio_venta_modal","precio_venta","disparadorDeItems","codigo_item_catalogo","item","user_conn","errorMessage","getAll","next","datav","error","err","complete","event","inputValue","target","value","encontrado","some","codigo","tarifa_get","num","Number","item_form","codtarifa_form","codtarifa","precio_actual","show","setTimeout","hide","warning","group","dataform","compose","required","precio","dialogRef","open","width","height","dataItem","afterClosed","result","validarPrecioItemPassword","modalPassword","dialogRefModalPasswordConfirm","dataA","dataB","permiso_id","permiso_text","submitData","update","tarifa_save","getPrecio","guardarLog","ventana","detalle","tipo","success","disparadorDeNombreVentana","emit","nombre_vent","selectors","viewQuery","i0","ctx"],"sourceRoot":"","sources":["C:\\laragon\\www\\SIAW-Angular-B\\src\\app\\components\\inventario\\operaciones\\precio-item\\precio-item.component.ts","C:\\laragon\\www\\SIAW-Angular-B\\src\\app\\components\\inventario\\operaciones\\precio-item\\precio-item.component.html"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatPaginator } from '@angular/material/paginator';\r\nimport { MatTableDataSource } from '@angular/material/table';\r\nimport { ApiService } from '@services/api.service';\r\nimport { LogService } from '@services/log-service.service';\r\nimport { NgxSpinnerService } from 'ngx-spinner';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { ValidarPrecioItemComponent } from './validar-precio-item/validar-precio-item.component';\r\nimport { ValidarPermisoItemComponent } from './validar-permiso-item/validar-permiso-item.component';\r\nimport { PermisoEspecialPasswordComponent } from '@components/seguridad/permiso-especial-password/permiso-especial-password.component';\r\nimport { NombreVentanaService } from '@modules/main/footer/servicio-nombre-ventana/nombre-ventana.service';\r\nimport { ItemServiceService } from '@components/mantenimiento/ventas/serviciosItem/item-service.service';\r\nimport { ServicioprecioventaService } from '@components/mantenimiento/ventas/servicioprecioventa/servicioprecioventa.service';\r\nimport { ModalPrecioVentaComponent } from '@components/mantenimiento/ventas/modal-precio-venta/modal-precio-venta.component';\r\nimport { ModalItemsComponent } from '@components/mantenimiento/ventas/modal-items/modal-items.component';\r\n@Component({\r\n  selector: 'app-precio-item',\r\n  templateUrl: './precio-item.component.html',\r\n  styleUrls: ['./precio-item.component.scss']\r\n})\r\nexport class PrecioItemComponent implements OnInit {\r\n\r\n  FormularioData:FormGroup;\r\n  fecha_actual = new Date();\r\n  hora_actual = new Date();\r\n  dataform:any='';\r\n  userConn: any;\r\n  usuarioLogueado: any;\r\n\r\n  tarifa_save: any = [];\r\n  tarifa_get: any = []\r\n  codigo_item_catalogo:any=[];\r\n  cod_precio_venta_modal:any=[];\r\n  codigo_item_catalogo_get: any = [];\r\n  precio_actual: any = [];\r\n  \r\n  public item=[]; \r\n  public data = [];\r\n  \r\n  displayedColumns = ['codigo','descripcion','descripcorta','descripabr','medida','unidad','accion'];\r\n\r\n  dataSource = new MatTableDataSource();\r\n  dataSourceWithPageSize = new MatTableDataSource();\r\n\r\n  @ViewChild('paginator') paginator: MatPaginator;\r\n  @ViewChild('paginatorPageSize') paginatorPageSize: MatPaginator;\r\n  \r\n  public nombre_ventana: string = \"prgindefinir_precioitem.vb\"; \r\n  public ventana=\"Definir Precio Item\"\r\n  public detalle=\"PrecioItem-UPDATE\";\r\n  public tipo = \"PrecioItem-UPDATE\";\r\n  \r\n  constructor(private api:ApiService, public dialog: MatDialog, private spinner: NgxSpinnerService, private toastr: ToastrService,\r\n    public log_module: LogService, private _formBuilder: FormBuilder,public itemservice:ItemServiceService, \r\n    public servicioPrecioVenta: ServicioprecioventaService, public nombre_ventana_service: NombreVentanaService) {\r\n    \r\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n    this.usuarioLogueado = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\r\n    \r\n    this.FormularioData = this.createForm();\r\n    this.mandarNombre();\r\n    this.api.getRolUserParaVentana(this.usuarioLogueado, this.nombre_ventana);\r\n  }\r\n\r\n  ngOnInit(){\r\n    this.getAllitem();\r\n    this.getTarifa();\r\n    \r\n    this.servicioPrecioVenta.disparadorDePrecioVenta.subscribe(data => {\r\n      console.log(\"Recibiendo Precio Venta: \", data);\r\n      this.cod_precio_venta_modal = data.precio_venta;\r\n    });\r\n\r\n    this.itemservice.disparadorDeItems.subscribe(data =>{\r\n      console.log(\"Recibiendo Item: \" , data);\r\n      this.codigo_item_catalogo = data.item;\r\n    });\r\n  }\r\n\r\n  getAllitem(){\r\n    let user_conn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n    let errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\r\n    return this.api.getAll('/inventario/mant/initem/catalogo/'+user_conn)\r\n      .subscribe({\r\n        next: (datav) => {\r\n          this.item = datav;\r\n          // console.log(this.item);\r\n        },\r\n        error: (err: any) => { \r\n          console.log(err, errorMessage);\r\n        },\r\n        complete: () => { }\r\n      })\r\n  }\r\n\r\n  onLeaveItem(event: any){\r\n    const inputValue = event.target.value;\r\n      \r\n    // Verificar si el valor ingresado está presente en los objetos del array\r\n    const encontrado = this.item.some(objeto => objeto.codigo === inputValue);\r\n\r\n    if(!encontrado){\r\n      // Si el valor no está en el array, dejar el campo vacío\r\n      event.target.value = '';\r\n      console.log(\"NO ENCONTRADO INPUT\");\r\n    } else {\r\n      event.target.value = inputValue;\r\n    }\r\n\r\n    // Puedes realizar otras acciones según tus necesidades\r\n    console.log('Input perdió el foco', inputValue);\r\n  }\r\n\r\n  getTarifa(){ \r\n    let errorMessage:string = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\r\n    return this.api.getAll('/inventario/mant/intarifa/catalogo/'+this.userConn+\"/\"+this.usuarioLogueado)\r\n      .subscribe({\r\n        next: (datav) => {\r\n          this.tarifa_get = datav;\r\n          // console.log(this.tarifa_get);\r\n        },\r\n        error: (err: any) => { \r\n          console.log(err, errorMessage);\r\n        },\r\n        complete: () => { }\r\n      })\r\n  }\r\n\r\n  onLeaveTarifa(event: any){\r\n    const inputValue = event.target.value;\r\n    let num = Number(inputValue);\r\n    // Verificar si el valor ingresado está presente en los objetos del array\r\n    const encontrado = this.tarifa_get.some(objeto => objeto.codigo === num);\r\n\r\n    if(!encontrado){\r\n      // Si el valor no está en el array, dejar el campo vacío\r\n      event.target.value = '';\r\n      console.log(\"NO ENCONTRADO INPUT\");\r\n    } else {\r\n      event.target.value = num;\r\n    }\r\n    // Puedes realizar otras acciones según tus necesidades\r\n    console.log('Input perdió el foco', num);\r\n  }\r\n\r\n  getPrecio(){\r\n    let data = this.FormularioData.value;\r\n    let errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET\";\r\n    let item_form = data.item; \r\n    let codtarifa_form = data.codtarifa;\r\n\r\n    if (item_form !== undefined && codtarifa_form !== undefined) {\r\n      return this.api.getAll('/inventario/oper/prgindefinir_precioitem/getTarifaItem/'+this.userConn+\"/\"+this.codigo_item_catalogo.codigo+\"/\"+this.cod_precio_venta_modal.codigo)\r\n        .subscribe({\r\n          next: (datav) => {\r\n            this.precio_actual = datav;\r\n            console.log(this.precio_actual);\r\n            \r\n            \r\n            this.spinner.show();\r\n            setTimeout(() => {\r\n              this.spinner.hide();\r\n            }, 1000);\r\n          },\r\n                  \r\n          error: (err: any) => { \r\n            console.log(err, errorMessage);\r\n          },\r\n          complete: () => { }\r\n        })\r\n    } else {\r\n        this.toastr.warning('INGRESE TODOS LOS CAMPOS');\r\n      }\r\n  }\r\n\r\n  createForm(): FormGroup{ \r\n    return this._formBuilder.group({\r\n      codtarifa: [this.dataform.codtarifa, Validators.compose([Validators.required])],\r\n      item: [this.dataform.item, Validators.compose([Validators.required])],\r\n      precio: [this.dataform.precio, Validators.compose([Validators.required])],\r\n    });\r\n  }\r\n\r\n  validarPrecioConfirmacion() { \r\n    let data = this.FormularioData.value;\r\n\r\n    const dialogRef = this.dialog.open(ValidarPrecioItemComponent, {\r\n      width: 'auto',\r\n      height: 'auto',\r\n      data:{dataItem:data}\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result: Boolean)=>{\r\n      if (result){\r\n        console.log(\"Validar Confirmado\");\r\n\r\n        if (result) {\r\n          this.validarPrecioItemPassword(data);\r\n        } else {\r\n          this.toastr.error('! NO SE CONFIRMADO !');\r\n        }\r\n      }else{\r\n        this.toastr.error('! CANCELADO !');\r\n      }\r\n    });\r\n  }\r\n\r\n  validarPrecioItemPassword(data) { \r\n      const dialogRef = this.dialog.open(ValidarPermisoItemComponent, {\r\n      width: 'auto',\r\n      height:'auto',\r\n      data:{data:data}\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result: Boolean)=>{\r\n      if(result) {\r\n        this.modalPassword(data);\r\n      }else{\r\n        this.toastr.error('! CANCELADO !');\r\n      }\r\n    });\r\n  }\r\n\r\n  modalPassword(data): void {\r\n    let precio = this.precio_actual.precio\r\n    console.log(precio);\r\n    \r\n    const dialogRefModalPasswordConfirm = this.dialog.open(PermisoEspecialPasswordComponent, {\r\n      width: 'auto',\r\n      height: 'auto',\r\n      data: {\r\n        dataA: precio, //dato A\r\n        dataB: data.precio, //dato B \r\n        permiso_id: \"106\", //esto es fijo siempre\r\n        permiso_text:\"CAMBIAR PRECIO DE ITEM\", //esto es fijo siempre\r\n      }\r\n    });\r\n\r\n    dialogRefModalPasswordConfirm.afterClosed().subscribe((result: any) => {\r\n      console.log(result);\r\n      if(result) {\r\n        this.submitData();\r\n      }else{\r\n        this.toastr.error('! CANCELADO NO SE GUARDO !');\r\n      }\r\n    });\r\n  }\r\n\r\n  submitData(){\r\n    let data = this.FormularioData.value;\r\n    console.log(data);\r\n    \r\n    let errorMessage = \"La Ruta presenta fallos al hacer la creacion\"+\"Ruta:- /inventario/oper/prgindefinir_precioitem/updateTarifa1/\";    \r\n    return this.api.update(\"/inventario/oper/prgindefinir_precioitem/updateTarifa1/\"+this.userConn, data)\r\n      .subscribe({\r\n        next: (datav) => {\r\n          if(data){\r\n            this.tarifa_save = datav;\r\n            this.getPrecio();\r\n            this.log_module.guardarLog(this.ventana,this.detalle, this.tipo);\r\n            this.toastr.success('Guardado con Exito! 🎉');\r\n          } else {\r\n            this.toastr.error('! ERROR AL GUARDAR !');\r\n          }\r\n        },\r\n    \r\n        error: (err) => { \r\n          console.log(err, errorMessage);\r\n          this.toastr.error('! NO SE GUARDO !');\r\n        },\r\n        complete: () => { }\r\n      })\r\n  }\r\n\r\n  modalPrecioTipo(): void {\r\n    this.dialog.open(ModalPrecioVentaComponent, {\r\n      width: 'auto',\r\n      height: 'auto',\r\n    });\r\n  }\r\n\r\n  modalItem(): void {\r\n    this.dialog.open(ModalItemsComponent, {\r\n      width: 'auto',\r\n      height: 'auto',\r\n    });\r\n  }\r\n\r\n  mandarNombre(){\r\n    this.nombre_ventana_service.disparadorDeNombreVentana.emit({\r\n      nombre_vent:this.ventana,\r\n    });\r\n  }\r\n}\r\n","<div class=\"p-2\">\r\n  <div class=\"overlay\"></div>\r\n\r\n  <ngx-spinner bdColor=\"rgba(251, 216, 0, 0.8)\" size=\"large\" color=\"#093070\" type=\"square-loader\" [fullScreen]=\"true\">\r\n    <br>\r\n    <p style=\"font-size: 25px; color: rgb(9,48,112,)\">🔩 Cargando... 🔩</p>\r\n  </ngx-spinner>\r\n\r\n  <div class=\"row\">\r\n    <div class=\"col-lg\">\r\n      <div class=\"p-2\">\r\n        <mat-card style=\"background-color: #f0f0f0;\">\r\n          <mat-card-header class=\"mb-1\">\r\n            <mat-card-title style=\"font-size: 0.8rem;\"><strong> Definir Precio Item</strong></mat-card-title>\r\n            <!-- <mat-card-subtitle>End</mat-card-subtitle> -->\r\n          </mat-card-header>\r\n\r\n          <mat-card-content>\r\n            <div class=\"row\">\r\n              <form [formGroup]=\"FormularioData\" (ngSubmit)=\"validarPrecioConfirmacion()\">\r\n                <tr>\r\n                  <th class=\"tg-0lax\">\r\n                    <div class=\"input-group\">\r\n                      <mat-label style=\"padding-right: 47px;padding-top: 3px;\"><u>Item</u></mat-label>\r\n                      <input type=\"text\" style=\"width: 59% !important;\" formControlName=\"item\"\r\n                        [(ngModel)]=\"codigo_item_catalogo.codigo\" (blur)=\"onLeaveItem($event)\">\r\n                      <div class=\"input-group-append\">\r\n                        <button class=\"btn btn-outline-primary\" type=\"button\" (click)=\"modalItem();\"\r\n                          style=\"border-color: #093070;padding: 4px 5px 1px 5px;line-height: 0 !important;\"\r\n                          matTooltip=\"Buscar Item\">\r\n                          <i class=\"fa fa-search\"></i>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </th>\r\n                  <th class=\"tg-0lax\">\r\n                    <div>\r\n                      {{ codigo_item_catalogo.descripcion }}\r\n                    </div>\r\n                  </th>\r\n                </tr>\r\n\r\n                <tr>\r\n                  <th class=\"tg-0lax\">\r\n                    <div class=\"input-group\">\r\n                      <mat-label style=\"padding-right: 8px;padding-top: 3px;\"><u>Precio Tipo</u></mat-label>\r\n                      <input type=\"text\" style=\"width: 59% !important;\" [(ngModel)]=\"cod_precio_venta_modal.codigo\"\r\n                        formControlName=\"codtarifa\" (blur)=\"onLeaveTarifa($event)\">\r\n                      <div class=\"input-group-append\">\r\n                        <button class=\"btn btn-outline-primary\" type=\"button\" (click)=\"modalPrecioTipo();\"\r\n                          style=\"border-color: #093070;padding: 4px 5px 1px 5px;line-height: 0 !important;\"\r\n                          matTooltip=\"Precios\">\r\n                          <i class=\"fa fa-search\"></i>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </th>\r\n                  <th class=\"tg-0lax\">\r\n                    <div>{{ cod_precio_venta_modal.descripcion }}</div>\r\n                  </th>\r\n                </tr>\r\n\r\n                <tr>\r\n                  <td class=\"tg-0lax\">\r\n                    <mat-label style=\"padding-right: 2px;\"><u>Precio Actual</u></mat-label>\r\n                    {{ precio_actual.precio | number: '1.5-5'}}\r\n                  </td>\r\n                  <td class=\"tg-0lax\">\r\n                    {{ precio_actual.monedaBase }}\r\n                  </td>\r\n                </tr>\r\n\r\n                <hr>\r\n\r\n                <tr>\r\n                  <td class=\"tg-0lax\">\r\n                    <mat-label style=\"padding-right: 0px;padding-top: 7px;\"><u>Precio Nuevo</u></mat-label>\r\n                    <input type=\"number\" formControlName=\"precio\" style=\"width: 70% !important;\" min=\"0\" [step]=\"0.00\">\r\n                  </td>\r\n                </tr>\r\n\r\n                <mat-card-actions align=\"start\">\r\n\r\n                  <button mat-raised-button color=\"primary\" type=\"submit\" [disabled]=\"!FormularioData.valid\">\r\n                    <i class=\"fa fa-cog\"></i> &nbsp;Cambiar\r\n                  </button>\r\n                </mat-card-actions>\r\n              </form>&nbsp;\r\n\r\n              <button mat-raised-button color=\"secondary\" (click)=\"getPrecio();\">\r\n                <i class=\"fa fa-retweet\" aria-hidden=\"true\"></i>&nbsp;Refrescar\r\n              </button>\r\n            </div>\r\n          </mat-card-content>\r\n        </mat-card>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}