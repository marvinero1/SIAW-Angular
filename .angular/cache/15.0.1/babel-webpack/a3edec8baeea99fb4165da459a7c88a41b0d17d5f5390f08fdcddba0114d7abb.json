{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { Gatekeeper } from 'gatekeeper-client-sdk';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ngx-toastr\";\nvar AppService = /** @class */function () {\n  function AppService(router, toastr) {\n    this.router = router;\n    this.toastr = toastr;\n    this.user = null;\n  }\n  // async loginByAuth({email, password}) {\n  //     try {\n  //         const token = await Gatekeeper.loginByAuth(email, password);\n  //         localStorage.setItem('token', token);\n  //         await this.getProfile();\n  //         this.router.navigate(['/']);\n  //         this.toastr.success('Login success');\n  //     } catch (error) {\n  //         this.toastr.error(error.message);\n  //     }\n  // }\n  AppService.prototype.registerByAuth = function (_a) {\n    var email = _a.email,\n      password = _a.password;\n    return __awaiter(this, void 0, void 0, function () {\n      var token, error_1;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _b.trys.push([0, 3,, 4]);\n            return [4 /*yield*/, Gatekeeper.registerByAuth(email, password)];\n          case 1:\n            token = _b.sent();\n            localStorage.setItem('token', token);\n            return [4 /*yield*/, this.getProfile()];\n          case 2:\n            _b.sent();\n            this.router.navigate(['/']);\n            this.toastr.success('Register success');\n            return [3 /*break*/, 4];\n          case 3:\n            error_1 = _b.sent();\n            this.toastr.error(error_1.message);\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AppService.prototype.loginByGoogle = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var token, error_2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 3,, 4]);\n            return [4 /*yield*/, Gatekeeper.loginByGoogle()];\n          case 1:\n            token = _a.sent();\n            localStorage.setItem('token', token);\n            return [4 /*yield*/, this.getProfile()];\n          case 2:\n            _a.sent();\n            this.router.navigate(['/']);\n            this.toastr.success('Login success');\n            return [3 /*break*/, 4];\n          case 3:\n            error_2 = _a.sent();\n            this.toastr.error(error_2.message);\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AppService.prototype.registerByGoogle = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var token, error_3;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 3,, 4]);\n            return [4 /*yield*/, Gatekeeper.registerByGoogle()];\n          case 1:\n            token = _a.sent();\n            localStorage.setItem('token', token);\n            return [4 /*yield*/, this.getProfile()];\n          case 2:\n            _a.sent();\n            this.router.navigate(['/']);\n            this.toastr.success('Register success');\n            return [3 /*break*/, 4];\n          case 3:\n            error_3 = _a.sent();\n            this.toastr.error(error_3.message);\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AppService.prototype.loginByFacebook = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var token, error_4;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 3,, 4]);\n            return [4 /*yield*/, Gatekeeper.loginByFacebook()];\n          case 1:\n            token = _a.sent();\n            localStorage.setItem('token', token);\n            return [4 /*yield*/, this.getProfile()];\n          case 2:\n            _a.sent();\n            this.router.navigate(['/']);\n            this.toastr.success('Login success');\n            return [3 /*break*/, 4];\n          case 3:\n            error_4 = _a.sent();\n            this.toastr.error(error_4.message);\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AppService.prototype.registerByFacebook = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var token, error_5;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            _a.trys.push([0, 3,, 4]);\n            return [4 /*yield*/, Gatekeeper.registerByFacebook()];\n          case 1:\n            token = _a.sent();\n            localStorage.setItem('token', token);\n            return [4 /*yield*/, this.getProfile()];\n          case 2:\n            _a.sent();\n            this.router.navigate(['/']);\n            this.toastr.success('Register success');\n            return [3 /*break*/, 4];\n          case 3:\n            error_5 = _a.sent();\n            this.toastr.error(error_5.message);\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AppService.prototype.getProfile = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, error_6;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _b.trys.push([0, 2,, 3]);\n            _a = this;\n            return [4 /*yield*/, Gatekeeper.getProfile()];\n          case 1:\n            _a.user = _b.sent();\n            return [3 /*break*/, 3];\n          case 2:\n            error_6 = _b.sent();\n            // this.logout();\n            throw error_6;\n          case 3:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AppService.ɵfac = function AppService_Factory(t) {\n    return new (t || AppService)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.ToastrService));\n  };\n  AppService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AppService,\n    factory: AppService.ɵfac,\n    providedIn: 'root'\n  });\n  return AppService;\n}();\nexport { AppService };","map":{"version":3,"mappings":"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","names":["Gatekeeper","router","toastr","AppService","_a","email","password","registerByAuth","token","_b","localStorage","setItem","getProfile","navigate","success","error","error_1","message","loginByGoogle","error_2","registerByGoogle","error_3","loginByFacebook","error_4","registerByFacebook","error_5","user","error_6","factory","providedIn"],"sourceRoot":"","sources":["C:\\laragon\\www\\SIAW-Angular-B\\src\\app\\services\\app.service.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\r\nimport {Router} from '@angular/router';\r\nimport {ToastrService} from 'ngx-toastr';\r\nimport {Gatekeeper} from 'gatekeeper-client-sdk';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class AppService {\r\n    public user: any = null;\r\n\r\n    constructor(private router: Router, private toastr: ToastrService) {}\r\n\r\n    // async loginByAuth({email, password}) {\r\n    //     try {\r\n    //         const token = await Gatekeeper.loginByAuth(email, password);\r\n    //         localStorage.setItem('token', token);\r\n    //         await this.getProfile();\r\n    //         this.router.navigate(['/']);\r\n    //         this.toastr.success('Login success');\r\n    //     } catch (error) {\r\n    //         this.toastr.error(error.message);\r\n    //     }\r\n    // }\r\n\r\n    async registerByAuth({email, password}) {\r\n        try {\r\n            const token = await Gatekeeper.registerByAuth(email, password);\r\n            localStorage.setItem('token', token);\r\n            await this.getProfile();\r\n            this.router.navigate(['/']);\r\n            this.toastr.success('Register success');\r\n        } catch (error) {\r\n            this.toastr.error(error.message);\r\n        }\r\n    }\r\n\r\n    async loginByGoogle() {\r\n        try {\r\n            const token = await Gatekeeper.loginByGoogle();\r\n            localStorage.setItem('token', token);\r\n            await this.getProfile();\r\n            this.router.navigate(['/']);\r\n            this.toastr.success('Login success');\r\n        } catch (error) {\r\n            this.toastr.error(error.message);\r\n        }\r\n    }\r\n\r\n    async registerByGoogle() {\r\n        try {\r\n            const token = await Gatekeeper.registerByGoogle();\r\n            localStorage.setItem('token', token);\r\n            await this.getProfile();\r\n            this.router.navigate(['/']);\r\n            this.toastr.success('Register success');\r\n        } catch (error) {\r\n            this.toastr.error(error.message);\r\n        }\r\n    }\r\n\r\n    async loginByFacebook() {\r\n        try {\r\n            const token = await Gatekeeper.loginByFacebook();\r\n            localStorage.setItem('token', token);\r\n            await this.getProfile();\r\n            this.router.navigate(['/']);\r\n            this.toastr.success('Login success');\r\n        } catch (error) {\r\n            this.toastr.error(error.message);\r\n        }\r\n    }\r\n\r\n    async registerByFacebook() {\r\n        try {\r\n            const token = await Gatekeeper.registerByFacebook();\r\n            localStorage.setItem('token', token);\r\n            await this.getProfile();\r\n            this.router.navigate(['/']);\r\n            this.toastr.success('Register success');\r\n        } catch (error) {\r\n            this.toastr.error(error.message);\r\n        }\r\n    }\r\n\r\n    async getProfile() {\r\n        try {\r\n            this.user = await Gatekeeper.getProfile();\r\n        } catch (error) {\r\n            // this.logout();\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // logout() {\r\n    //     localStorage.removeItem('usuario_logueado');\r\n    //     localStorage.removeItem('gatekeeper_token');  \r\n    //     this.user = null;\r\n    //     this.router.navigate(['/login']);\r\n    // }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}