{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst tslib_1 = require(\"tslib\");\nconst tab_1 = require(\"./core/tab\");\nconst js_base64_1 = require(\"js-base64\");\nconst fingerprintjs_1 = require(\"@fingerprintjs/fingerprintjs\");\nclass Gatekeeper {\n  constructor() {\n    this.LOCALSTORAGE_IDENTIFIER = 'gatekeeper_token';\n    this.URL = 'https://gatekeeper-api.profabric.tech';\n    this.payload = {\n      accountID: null,\n      clientURL: null,\n      browserID: null\n    };\n    this.tab = new tab_1.Tab();\n    fingerprintjs_1.default.load().then(fp => fp.get()).then(({\n      visitorId\n    }) => this.payload.browserID = visitorId);\n  }\n  getBase64Payload(additional) {\n    const data = Object.assign(Object.assign({}, this.payload), additional);\n    return (0, js_base64_1.encode)(JSON.stringify(data));\n  }\n  static getInstance() {\n    if (!Gatekeeper.instance) {\n      Gatekeeper.instance = new Gatekeeper();\n    }\n    return Gatekeeper.instance;\n  }\n  initialize(accountID) {\n    this.payload.accountID = accountID;\n    this.payload.clientURL = `${location.protocol}//${location.host}`;\n  }\n  loginByAuth(email, password) {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      try {\n        const response = yield fetch(`${this.URL}/v1/auth/login`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            AccountID: this.payload.accountID\n          },\n          body: JSON.stringify({\n            email,\n            password\n          })\n        });\n        const data = yield response.json();\n        if (data && data.status && data.message) {\n          throw new Error(data.message);\n        }\n        localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, data.token);\n        return data.token;\n      } catch (error) {\n        console.log(error);\n        throw error;\n      }\n    });\n  }\n  registerByAuth(email, password) {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      try {\n        const response = yield fetch(`${this.URL}/v1/auth/register`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            AccountID: this.payload.accountID\n          },\n          body: JSON.stringify({\n            email,\n            password\n          })\n        });\n        const data = yield response.json();\n        if (data && data.status && data.message) {\n          throw new Error(data.message);\n        }\n        localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, data.token);\n        return data.token;\n      } catch (error) {\n        console.log(error);\n        throw error;\n      }\n    });\n  }\n  loginByGoogle() {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      try {\n        const {\n          token\n        } = yield this.tab.open(`${this.URL}/v1/auth/google?payload=${this.getBase64Payload({\n          type: 'LOGIN'\n        })}`);\n        localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n        return token;\n      } catch (error) {\n        console.log(error);\n        throw error;\n      }\n    });\n  }\n  registerByGoogle() {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      try {\n        const {\n          token\n        } = yield this.tab.open(`${this.URL}/v1/auth/google?payload=${this.getBase64Payload({\n          type: 'REGISTER'\n        })}`);\n        localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n        return token;\n      } catch (error) {\n        console.log(error);\n        throw error;\n      }\n    });\n  }\n  loginByFacebook() {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      try {\n        const {\n          token\n        } = yield this.tab.open(`${this.URL}/v1/auth/facebook?payload=${this.getBase64Payload({\n          type: 'LOGIN'\n        })}`);\n        localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n        return token;\n      } catch (error) {\n        console.log(error);\n        throw error;\n      }\n    });\n  }\n  registerByFacebook() {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      try {\n        const {\n          token\n        } = yield this.tab.open(`${this.URL}/v1/auth/facebook?payload=${this.getBase64Payload({\n          type: 'REGISTER'\n        })}`);\n        localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n        return token;\n      } catch (error) {\n        console.log(error);\n        throw error;\n      }\n    });\n  }\n  getProfile() {\n    return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      const token = localStorage.getItem(this.LOCALSTORAGE_IDENTIFIER);\n      const response = yield fetch(`${this.URL}/v1/users/profile`, {\n        headers: {\n          'Content-Type': 'application/json',\n          AccountID: this.payload.accountID,\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const data = yield response.json();\n      if (data && data.status && data.message) {\n        throw new Error(data.message);\n      }\n      return data;\n    });\n  }\n}\nexports.default = Gatekeeper.getInstance();","map":{"version":3,"names":["Object","defineProperty","exports","value","tslib_1","require","tab_1","js_base64_1","fingerprintjs_1","Gatekeeper","constructor","LOCALSTORAGE_IDENTIFIER","URL","payload","accountID","clientURL","browserID","tab","Tab","default","load","then","fp","get","visitorId","getBase64Payload","additional","data","assign","encode","JSON","stringify","getInstance","instance","initialize","location","protocol","host","loginByAuth","email","password","__awaiter","response","fetch","method","headers","AccountID","body","json","status","message","Error","localStorage","setItem","token","error","console","log","registerByAuth","loginByGoogle","open","type","registerByGoogle","loginByFacebook","registerByFacebook","getProfile","getItem","Authorization"],"sources":["C:/laragon/www/SIAW-Angular-B/node_modules/gatekeeper-client-sdk/src/gatekeeper.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst tab_1 = require(\"./core/tab\");\nconst js_base64_1 = require(\"js-base64\");\nconst fingerprintjs_1 = require(\"@fingerprintjs/fingerprintjs\");\nclass Gatekeeper {\n    constructor() {\n        this.LOCALSTORAGE_IDENTIFIER = 'gatekeeper_token';\n        this.URL = 'https://gatekeeper-api.profabric.tech';\n        this.payload = {\n            accountID: null,\n            clientURL: null,\n            browserID: null,\n        };\n        this.tab = new tab_1.Tab();\n        fingerprintjs_1.default.load()\n            .then((fp) => fp.get())\n            .then(({ visitorId }) => (this.payload.browserID = visitorId));\n    }\n    getBase64Payload(additional) {\n        const data = Object.assign(Object.assign({}, this.payload), additional);\n        return (0, js_base64_1.encode)(JSON.stringify(data));\n    }\n    static getInstance() {\n        if (!Gatekeeper.instance) {\n            Gatekeeper.instance = new Gatekeeper();\n        }\n        return Gatekeeper.instance;\n    }\n    initialize(accountID) {\n        this.payload.accountID = accountID;\n        this.payload.clientURL = `${location.protocol}//${location.host}`;\n    }\n    loginByAuth(email, password) {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            try {\n                const response = yield fetch(`${this.URL}/v1/auth/login`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        AccountID: this.payload.accountID,\n                    },\n                    body: JSON.stringify({ email, password }),\n                });\n                const data = yield response.json();\n                if (data && data.status && data.message) {\n                    throw new Error(data.message);\n                }\n                localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, data.token);\n                return data.token;\n            }\n            catch (error) {\n                console.log(error);\n                throw error;\n            }\n        });\n    }\n    registerByAuth(email, password) {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            try {\n                const response = yield fetch(`${this.URL}/v1/auth/register`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        AccountID: this.payload.accountID,\n                    },\n                    body: JSON.stringify({ email, password }),\n                });\n                const data = yield response.json();\n                if (data && data.status && data.message) {\n                    throw new Error(data.message);\n                }\n                localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, data.token);\n                return data.token;\n            }\n            catch (error) {\n                console.log(error);\n                throw error;\n            }\n        });\n    }\n    loginByGoogle() {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            try {\n                const { token } = yield this.tab.open(`${this.URL}/v1/auth/google?payload=${this.getBase64Payload({\n                    type: 'LOGIN',\n                })}`);\n                localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n                return token;\n            }\n            catch (error) {\n                console.log(error);\n                throw error;\n            }\n        });\n    }\n    registerByGoogle() {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            try {\n                const { token } = yield this.tab.open(`${this.URL}/v1/auth/google?payload=${this.getBase64Payload({\n                    type: 'REGISTER',\n                })}`);\n                localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n                return token;\n            }\n            catch (error) {\n                console.log(error);\n                throw error;\n            }\n        });\n    }\n    loginByFacebook() {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            try {\n                const { token } = yield this.tab.open(`${this.URL}/v1/auth/facebook?payload=${this.getBase64Payload({\n                    type: 'LOGIN',\n                })}`);\n                localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n                return token;\n            }\n            catch (error) {\n                console.log(error);\n                throw error;\n            }\n        });\n    }\n    registerByFacebook() {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            try {\n                const { token } = yield this.tab.open(`${this.URL}/v1/auth/facebook?payload=${this.getBase64Payload({\n                    type: 'REGISTER',\n                })}`);\n                localStorage.setItem(this.LOCALSTORAGE_IDENTIFIER, token);\n                return token;\n            }\n            catch (error) {\n                console.log(error);\n                throw error;\n            }\n        });\n    }\n    getProfile() {\n        return (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n            const token = localStorage.getItem(this.LOCALSTORAGE_IDENTIFIER);\n            const response = yield fetch(`${this.URL}/v1/users/profile`, {\n                headers: {\n                    'Content-Type': 'application/json',\n                    AccountID: this.payload.accountID,\n                    Authorization: `Bearer ${token}`,\n                },\n            });\n            const data = yield response.json();\n            if (data && data.status && data.message) {\n                throw new Error(data.message);\n            }\n            return data;\n        });\n    }\n}\nexports.default = Gatekeeper.getInstance();\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}