{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { EventEmitter } from '@angular/core';\nimport { HttpHeaders } from '@angular/common/http';\nimport { catchError, throwError } from 'rxjs';\nimport { RefreshPasswordComponent } from '@modules/refresh-password/refresh-password.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"ngx-spinner\";\nimport * as i4 from \"@angular/material/snack-bar\";\nimport * as i5 from \"@angular/material/dialog\";\nimport * as i6 from \"ngx-toastr\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"./periodoSistema/periodo-sistema.service\";\nvar ApiService = /** @class */function () {\n  function ApiService(http, router, spinner, _snackBar, dialog, toastr, datePipe, periodoSistemaService) {\n    this.http = http;\n    this.router = router;\n    this.spinner = spinner;\n    this._snackBar = _snackBar;\n    this.dialog = dialog;\n    this.toastr = toastr;\n    this.datePipe = datePipe;\n    this.periodoSistemaService = periodoSistemaService;\n    this.ventana_estado = [{\n      ventana: \"\",\n      url: \"\",\n      estado: \"\"\n    }];\n    this.data = [];\n    this.newItemEvent = new EventEmitter();\n    this.API_URL = 'https://192.168.31.240/API_SIAW/api';\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    this.BD_storage = localStorage.getItem(\"bd_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"bd_logueado\")) : null;\n    console.log(this.ventana_estado);\n  }\n  ApiService.prototype.login = function (url, data) {\n    return this.http.post(this.API_URL + url, data).pipe(catchError(function (err) {\n      console.log('Error en Login api.services');\n      console.error(err);\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.getAll = function (url) {\n    return this.http.get(this.API_URL + url).pipe(catchError(function (err) {\n      console.log('getAll Servicio');\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.createAllWithOutToken = function (url, obj) {\n    return this.http.post(this.API_URL + url, obj).pipe(catchError(function (err) {\n      console.log('error caught in service');\n      console.error(err);\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.create = function (url, obj) {\n    this.token = localStorage.getItem(\"token\") !== undefined ? JSON.parse(localStorage.getItem(\"token\")) : null;\n    console.log(this.token.token);\n    var httpOptions = {\n      headers: new HttpHeaders({\n        \"Authorization\": \"bearer\" + \" \" + this.token.token\n      })\n    };\n    return this.http.post(this.API_URL + url, obj, httpOptions).pipe(catchError(function (err) {\n      console.log('error caught in service');\n      console.log(err);\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.update = function (url, obj) {\n    this.token = localStorage.getItem(\"token\") !== undefined ? JSON.parse(localStorage.getItem(\"token\")) : null;\n    console.log(this.token.token);\n    var httpOptions = {\n      headers: new HttpHeaders({\n        \"Authorization\": \"bearer\" + \" \" + this.token.token\n      })\n    };\n    return this.http.put(this.API_URL + url, obj, httpOptions).pipe(catchError(function (err) {\n      console.log('Error en el servicio de UPDATE');\n      console.error(err);\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.delete = function (id) {\n    this.token = localStorage.getItem(\"token\") !== undefined ? JSON.parse(localStorage.getItem(\"token\")) : null;\n    console.log(this.token.token);\n    var httpOptions = {\n      headers: new HttpHeaders({\n        \"Authorization\": \"bearer\" + \" \" + this.token.token\n      })\n    };\n    return this.http.delete(this.API_URL + id, httpOptions).pipe(catchError(function (err) {\n      console.log('error caught in service in delete service');\n      console.error(err);\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.getById = function (id) {\n    return this.http.get(this.API_URL + id).pipe(\n    //Aumentar el ID al momento de traer\n    catchError(function (err) {\n      console.log('error caught in service');\n      console.error(err);\n      return throwError(function () {\n        return new Error();\n      });\n    }));\n  };\n  ApiService.prototype.obtenerUsuarioLogueado = function () {\n    this.dato_local_storage = localStorage.getItem('usuario_logueado');\n    this.dato_local_session = sessionStorage.getItem('usuario_logueado');\n  };\n  ApiService.prototype.obtenerUsuarioStorage = function () {\n    this.usuario_storage = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\n    return this.usuario_storage;\n  };\n  ApiService.prototype.obtenerAgenciaStorage = function () {\n    this.agencia_storage = localStorage.getItem(\"agencia_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"agencia_logueado\")) : null;\n    return this.agencia_storage;\n  };\n  ApiService.prototype.obtenerToken = function () {\n    console.log(this.token, JSON.parse(this.token));\n    return this.token = localStorage.getItem('token');\n  };\n  ApiService.prototype.obtenerAgencia = function () {\n    console.log(this.agencia, JSON.parse(this.agencia));\n    return this.agencia = localStorage.getItem('agencia_logueado');\n  };\n  ApiService.prototype.verificarToken = function () {\n    var token = localStorage.getItem('token');\n    return this.delete('/seg_adm/login/eliminaToken/' + token).subscribe({\n      next: function (datav) {\n        console.log('Token Eliminado');\n      },\n      error: function (err) {\n        console.log(err, 'No se pudo eliminar el token, revise la ruta!');\n      },\n      complete: function () {}\n    });\n  };\n  ApiService.prototype.eliminarToken = function () {\n    var token = localStorage.getItem('token');\n    var useConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    return this.delete('/seg_adm/login/logout/' + useConn + \"/\" + token).subscribe({\n      next: function (datav) {},\n      error: function (err) {\n        console.log(err, 'No se pudo eliminar el token, revise la ruta!');\n      },\n      complete: function () {}\n    });\n  };\n  //Funcion que verifica la accesibilidad de las ventanas\n  //cod_rol, seprograma\n  ApiService.prototype.verificarAccesoVentanaGlobal = function (cod_rol, nombre_venta) {\n    var _this = this;\n    var data = {\n      \"codrol\": cod_rol,\n      \"programa\": nombre_venta\n    };\n    var userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    var errorMessage = \"La Ruta presenta fallos al hacer peticion POST --/seg_adm/oper/verificaserolprogs/\";\n    return this.create('/seg_adm/oper/prgaccesosrol/verificaserolprogs/' + userConn, data).subscribe({\n      next: function (datav) {\n        console.log(datav);\n        if (datav == true) {\n          setTimeout(function () {\n            _this.spinner.hide();\n          }, 1500);\n        }\n      },\n      error: function (err) {\n        console.log(err, errorMessage);\n        _this.toastr.error('SIN Acceso a la Ventana! ðŸ˜¢');\n        _this.router.navigate(['/']);\n      },\n      complete: function () {}\n    });\n  };\n  ApiService.prototype.refrescarContrasenia = function () {\n    // Esta funcion abre un modal en el cual coloca una nueva contrasenia si la actual ya vencio\n    var dialogRef = this.dialog.open(RefreshPasswordComponent, {\n      width: 'auto',\n      height: 'auto'\n    });\n    dialogRef.afterClosed().subscribe(function (result) {\n      console.log('Modal de Refrescar Contrasenia cerrado');\n    });\n  };\n  ApiService.prototype.getRolUserParaVentana = function (user, ventana) {\n    var _this = this;\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    var errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET, en la ruta /seg_adm/logs/selog/getselogfecha/  --Vista LOG/Angular\";\n    return this.getAll('/seg_adm/mant/adusuario/' + this.userConn + \"/\" + user).subscribe({\n      next: function (datav) {\n        _this.rol = datav.codrol;\n        console.log(_this.rol);\n        _this.verificarAccesoVentanaGlobal(_this.rol, ventana);\n      },\n      error: function (err) {\n        console.log(err, errorMessage);\n      },\n      complete: function () {}\n    });\n  };\n  ApiService.prototype.getVerificarPeriodoAbierto = function (fecha, modulo) {\n    var _this = this;\n    console.log(fecha, modulo);\n    var date_pipe;\n    // retorna un true/false\n    /* 'detalle de modulos\r\n        '1 : administracion\r\n        '2 : inventario\r\n        '3 : ventas\r\n        '4 : cuentas por cobrar\r\n        '5 : contabilidad\r\n        '6 : activos fijos\r\n        '7 : costo y costeo\r\n        '8 : compras y ctas por pagar\r\n        '9 : personal y planillas\r\n        '10: seguridad\r\n        '11: compras menores\r\n        '12: fondos\r\n    */\n    date_pipe = this.datePipe.transform(fecha, \"yyyy-MM-dd\");\n    this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\n    var errorMessage = \"La Ruta presenta fallos al hacer peticion GET, en la ruta /seg_adm/mant/abmadapertura/verificaPeriodoAbierto/ --Vista LOG/Angular\";\n    this.getAll('/seg_adm/mant/abmadapertura/verifPeriodoAbierto/' + this.userConn + \"/\" + date_pipe + \"/\" + modulo).subscribe({\n      next: function (datav) {\n        _this.periodo_abierto = datav;\n        console.log(_this.periodo_abierto);\n        if (_this.periodo_abierto == true) {\n          _this.toastr.success('! PERIODO ABIERTO !');\n          _this.periodoSistemaService.disparadorDeBooleanoPeriodoSistema.emit({\n            periodo: true\n          });\n        } else {\n          _this.toastr.warning('! PERIODO CERRADO !');\n          _this.periodoSistemaService.disparadorDeBooleanoPeriodoSistema.emit({\n            periodo: false\n          });\n        }\n        return _this.periodo_abierto;\n      },\n      error: function (err) {\n        console.log(err, errorMessage);\n      },\n      complete: function () {}\n    });\n  };\n  ApiService.prototype.ventanaAbiertaCerrada = function (nombre_ventana, ruta, estado) {\n    var _this = this;\n    this.ventana_estado.push({\n      ventana: nombre_ventana,\n      ruta: ruta,\n      estado: estado\n    });\n    console.log(this.ventana_estado);\n    if (!this.ventana_estado.find(function (elemento) {\n      return elemento.nombre_ventana === _this.ventana_estado.ventana;\n    })) {\n      this.ventana_estado.push({\n        ventana: nombre_ventana,\n        ruta: ruta,\n        estado: estado\n      });\n    } else {\n      console.log(\"La ventana ya esta agregada\");\n    }\n  };\n  ApiService.prototype.logout = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        localStorage.removeItem(\"usuario_logueado\");\n        sessionStorage.removeItem(\"usuario_logueado\");\n        localStorage.removeItem(\"agencia_logueado\");\n        sessionStorage.removeItem(\"agencia_logueado\");\n        localStorage.removeItem(\"bd_logueado\");\n        sessionStorage.removeItem(\"bd_logueado\");\n        localStorage.removeItem(\"user_conn\");\n        sessionStorage.removeItem(\"user_conn\");\n        this.eliminarToken();\n        localStorage.removeItem(\"token\");\n        sessionStorage.removeItem(\"token\");\n        return [2 /*return*/, this.router.navigate(['/login'])];\n      });\n    });\n  };\n  ApiService.Éµfac = function ApiService_Factory(t) {\n    return new (t || ApiService)(i0.ÉµÉµinject(i1.HttpClient), i0.ÉµÉµinject(i2.Router), i0.ÉµÉµinject(i3.NgxSpinnerService), i0.ÉµÉµinject(i4.MatSnackBar), i0.ÉµÉµinject(i5.MatDialog), i0.ÉµÉµinject(i6.ToastrService), i0.ÉµÉµinject(i7.DatePipe), i0.ÉµÉµinject(i8.PeriodoSistemaService));\n  };\n  ApiService.Éµprov = /*@__PURE__*/i0.ÉµÉµdefineInjectable({\n    token: ApiService,\n    factory: ApiService.Éµfac,\n    providedIn: 'root'\n  });\n  return ApiService;\n}();\nexport { ApiService };","map":{"version":3,"mappings":"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","names":["EventEmitter","HttpHeaders","catchError","throwError","RefreshPasswordComponent","http","router","spinner","_snackBar","dialog","toastr","datePipe","periodoSistemaService","ventana","url","estado","userConn","localStorage","getItem","undefined","JSON","parse","BD_storage","console","log","ventana_estado","ApiService","data","post","API_URL","pipe","err","error","Error","get","obj","token","httpOptions","headers","put","id","delete","dato_local_storage","dato_local_session","sessionStorage","usuario_storage","agencia_storage","agencia","subscribe","next","datav","complete","useConn","cod_rol","nombre_venta","errorMessage","create","setTimeout","_this","hide","navigate","dialogRef","open","width","height","afterClosed","user","getAll","rol","codrol","verificarAccesoVentanaGlobal","fecha","modulo","date_pipe","transform","periodo_abierto","success","disparadorDeBooleanoPeriodoSistema","emit","periodo","warning","nombre_ventana","ruta","push","find","removeItem","eliminarToken","factory","providedIn"],"sourceRoot":"","sources":["C:\\laragon\\www\\SIAW-Angular-B\\src\\app\\services\\api.service.ts"],"sourcesContent":["import { EventEmitter, Injectable, Output } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Observable, catchError, throwError } from 'rxjs';\r\nimport { Router } from '@angular/router';\r\nimport { NgxSpinnerService } from 'ngx-spinner';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { RefreshPasswordComponent } from '@modules/refresh-password/refresh-password.component';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { DatePipe } from '@angular/common';\r\nimport { PeriodoSistemaService } from './periodoSistema/periodo-sistema.service';\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\n\r\nexport class ApiService {\r\n\r\n    public ventana_estado: any = [{\r\n        ventana: \"\",\r\n        url: \"\",\r\n        estado: \"\",\r\n    }]\r\n\r\n    data: any = [];\r\n    rol: any;\r\n    code_error: number;\r\n    @Output() newItemEvent = new EventEmitter<string>();\r\n\r\n    public dato_local_storage;\r\n    public dato_local_session;\r\n    public token;\r\n    public agencia;\r\n    public usuario_logueado: any;\r\n    public session: any;\r\n    public userConn: any;\r\n    public BD_storage: any;\r\n    public monedaBase: any;\r\n    public usuario_storage;\r\n    public agencia_storage;\r\n    public periodo_abierto;\r\n\r\n    private readonly API_URL = 'https://192.168.31.240/API_SIAW/api';\r\n\r\n    constructor(private http: HttpClient, private router: Router, private spinner: NgxSpinnerService,\r\n        public _snackBar: MatSnackBar, public dialog: MatDialog, private toastr: ToastrService, private datePipe: DatePipe,\r\n        public periodoSistemaService: PeriodoSistemaService) {\r\n        this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n        this.BD_storage = localStorage.getItem(\"bd_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"bd_logueado\")) : null;\r\n\r\n        console.log(this.ventana_estado);\r\n    }\r\n\r\n    login(url: string, data): Observable<any> {\r\n        return this.http.post(this.API_URL + url, data).pipe(\r\n            catchError((err) => {\r\n                console.log('Error en Login api.services')\r\n                console.error(err);\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    getAll(url: string): Observable<any> {\r\n        return this.http.get<object[]>(this.API_URL + url).pipe(\r\n            catchError((err) => {\r\n                console.log('getAll Servicio')\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    createAllWithOutToken(url: string, obj): Observable<any> {\r\n        return this.http.post(this.API_URL + url, obj).pipe(\r\n            catchError((err) => {\r\n                console.log('error caught in service')\r\n                console.error(err);\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    create(url: string, obj): Observable<any> {\r\n        this.token = localStorage.getItem(\"token\") !== undefined ? JSON.parse(localStorage.getItem(\"token\")) : null;\r\n        console.log(this.token.token);\r\n\r\n        const httpOptions = {\r\n            headers: new HttpHeaders({\r\n                \"Authorization\": \"bearer\" + \" \" + this.token.token,\r\n            })\r\n        };\r\n\r\n        return this.http.post(this.API_URL + url, obj, httpOptions).pipe(\r\n            catchError((err) => {\r\n                console.log('error caught in service')\r\n                console.log(err);\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    update(url: string, obj): Observable<any> {\r\n        this.token = localStorage.getItem(\"token\") !== undefined ? JSON.parse(localStorage.getItem(\"token\")) : null;\r\n        console.log(this.token.token);\r\n\r\n        const httpOptions = {\r\n            headers: new HttpHeaders({\r\n                \"Authorization\": \"bearer\" + \" \" + this.token.token,\r\n            })\r\n        };\r\n\r\n        return this.http.put(this.API_URL + url, obj, httpOptions).pipe(\r\n            catchError((err) => {\r\n                console.log('Error en el servicio de UPDATE')\r\n                console.error(err);\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    delete(id: string) {\r\n        this.token = localStorage.getItem(\"token\") !== undefined ? JSON.parse(localStorage.getItem(\"token\")) : null;\r\n        console.log(this.token.token);\r\n\r\n        const httpOptions = {\r\n            headers: new HttpHeaders({\r\n                \"Authorization\": \"bearer\" + \" \" + this.token.token,\r\n            })\r\n        };\r\n\r\n        return this.http.delete(this.API_URL + id, httpOptions).pipe(\r\n            catchError((err) => {\r\n                console.log('error caught in service in delete service')\r\n                console.error(err);\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    getById(id: string): Observable<any> {\r\n        return this.http.get(this.API_URL + id).pipe(//Aumentar el ID al momento de traer\r\n            catchError((err) => {\r\n                console.log('error caught in service')\r\n                console.error(err);\r\n                return throwError(() => new Error());\r\n            })\r\n        )\r\n    }\r\n\r\n    obtenerUsuarioLogueado() {\r\n        this.dato_local_storage = localStorage.getItem('usuario_logueado');\r\n        this.dato_local_session = sessionStorage.getItem('usuario_logueado');\r\n    }\r\n\r\n    obtenerUsuarioStorage() {\r\n        this.usuario_storage = localStorage.getItem(\"usuario_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"usuario_logueado\")) : null;\r\n        return this.usuario_storage;\r\n    }\r\n\r\n    obtenerAgenciaStorage() {\r\n        this.agencia_storage = localStorage.getItem(\"agencia_logueado\") !== undefined ? JSON.parse(localStorage.getItem(\"agencia_logueado\")) : null;\r\n        return this.agencia_storage;\r\n    }\r\n\r\n    obtenerToken() {\r\n        console.log(this.token, JSON.parse(this.token));\r\n        return this.token = localStorage.getItem('token');\r\n    }\r\n\r\n    obtenerAgencia() {\r\n        console.log(this.agencia, JSON.parse(this.agencia));\r\n        return this.agencia = localStorage.getItem('agencia_logueado');\r\n    }\r\n\r\n    verificarToken() {\r\n        let token = localStorage.getItem('token');\r\n\r\n        return this.delete('/seg_adm/login/eliminaToken/' + token)\r\n            .subscribe({\r\n                next: (datav) => {\r\n                    console.log('Token Eliminado');\r\n                },\r\n                error: (err: any) => {\r\n                    console.log(err, 'No se pudo eliminar el token, revise la ruta!');\r\n                },\r\n                complete: () => { }\r\n            })\r\n    }\r\n\r\n    eliminarToken() {\r\n        let token = localStorage.getItem('token');\r\n        let useConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n\r\n        return this.delete('/seg_adm/login/logout/' + useConn + \"/\" + token)\r\n            .subscribe({\r\n                next: (datav) => {\r\n                },\r\n                error: (err: any) => {\r\n                    console.log(err, 'No se pudo eliminar el token, revise la ruta!');\r\n                },\r\n                complete: () => { }\r\n            })\r\n    }\r\n\r\n    //Funcion que verifica la accesibilidad de las ventanas\r\n    //cod_rol, seprograma\r\n    verificarAccesoVentanaGlobal(cod_rol, nombre_venta) {\r\n        let data: any = { \"codrol\": cod_rol, \"programa\": nombre_venta };\r\n        let userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n        let errorMessage = \"La Ruta presenta fallos al hacer peticion POST --/seg_adm/oper/verificaserolprogs/\";\r\n\r\n        return this.create('/seg_adm/oper/prgaccesosrol/verificaserolprogs/' + userConn, data)\r\n            .subscribe({\r\n                next: (datav) => {\r\n                    console.log(datav);\r\n                    if (datav == true) {\r\n                        setTimeout(() => {\r\n                            this.spinner.hide();\r\n                        }, 1500);\r\n                    }\r\n                },\r\n                error: (err: any) => {\r\n                    console.log(err, errorMessage);\r\n                    this.toastr.error('SIN Acceso a la Ventana! ðŸ˜¢',);\r\n                    this.router.navigate(['/']);\r\n                },\r\n                complete: () => { }\r\n            })\r\n    }\r\n\r\n    refrescarContrasenia(): void {\r\n        // Esta funcion abre un modal en el cual coloca una nueva contrasenia si la actual ya vencio\r\n        const dialogRef = this.dialog.open(RefreshPasswordComponent, {\r\n            width: 'auto',\r\n            height: 'auto',\r\n        });\r\n\r\n        dialogRef.afterClosed().subscribe(result => {\r\n            console.log('Modal de Refrescar Contrasenia cerrado');\r\n        });\r\n    }\r\n\r\n    getRolUserParaVentana(user, ventana) {\r\n        this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n\r\n        let errorMessage = \"La Ruta o el servidor presenta fallos al hacer peticion GET, en la ruta /seg_adm/logs/selog/getselogfecha/  --Vista LOG/Angular\";\r\n        return this.getAll('/seg_adm/mant/adusuario/' + this.userConn + \"/\" + user)\r\n            .subscribe({\r\n                next: (datav) => {\r\n                    this.rol = datav.codrol;\r\n                    console.log(this.rol);\r\n                    this.verificarAccesoVentanaGlobal(this.rol, ventana);\r\n                },\r\n\r\n                error: (err: any) => {\r\n                    console.log(err, errorMessage);\r\n                },\r\n                complete: () => { }\r\n            })\r\n    }\r\n\r\n    getVerificarPeriodoAbierto(fecha, modulo) {\r\n        console.log(fecha, modulo);\r\n\r\n        let date_pipe;\r\n        // retorna un true/false\r\n        /* 'detalle de modulos\r\n            '1 : administracion\r\n            '2 : inventario\r\n            '3 : ventas\r\n            '4 : cuentas por cobrar\r\n            '5 : contabilidad\r\n            '6 : activos fijos\r\n            '7 : costo y costeo\r\n            '8 : compras y ctas por pagar\r\n            '9 : personal y planillas\r\n            '10: seguridad\r\n            '11: compras menores\r\n            '12: fondos\r\n        */\r\n\r\n        date_pipe = this.datePipe.transform(fecha, \"yyyy-MM-dd\")\r\n        this.userConn = localStorage.getItem(\"user_conn\") !== undefined ? JSON.parse(localStorage.getItem(\"user_conn\")) : null;\r\n\r\n        let errorMessage = \"La Ruta presenta fallos al hacer peticion GET, en la ruta /seg_adm/mant/abmadapertura/verificaPeriodoAbierto/ --Vista LOG/Angular\";\r\n        this.getAll('/seg_adm/mant/abmadapertura/verifPeriodoAbierto/' + this.userConn + \"/\" + date_pipe + \"/\" + modulo)\r\n            .subscribe({\r\n                next: (datav) => {\r\n                    this.periodo_abierto = datav;\r\n                    console.log(this.periodo_abierto);\r\n\r\n                    if (this.periodo_abierto == true) {\r\n                        this.toastr.success('! PERIODO ABIERTO !');\r\n                        this.periodoSistemaService.disparadorDeBooleanoPeriodoSistema.emit({\r\n                            periodo: true,\r\n                        });\r\n                    } else {\r\n                        this.toastr.warning('! PERIODO CERRADO !');\r\n                        this.periodoSistemaService.disparadorDeBooleanoPeriodoSistema.emit({\r\n                            periodo: false,\r\n                        });\r\n                    }\r\n\r\n                    return this.periodo_abierto;\r\n                },\r\n\r\n                error: (err: any) => {\r\n                    console.log(err, errorMessage);\r\n                },\r\n                complete: () => { }\r\n            })\r\n    }\r\n\r\n    ventanaAbiertaCerrada(nombre_ventana, ruta, estado) {\r\n        this.ventana_estado.push({ ventana: nombre_ventana, ruta: ruta, estado: estado });\r\n\r\n        console.log(this.ventana_estado);\r\n\r\n        if (!this.ventana_estado.find(elemento => elemento.nombre_ventana === this.ventana_estado.ventana)) {\r\n            this.ventana_estado.push({ ventana: nombre_ventana, ruta: ruta, estado: estado });\r\n        } else {\r\n            console.log(\"La ventana ya esta agregada\");\r\n\r\n        }\r\n    }\r\n\r\n    async logout() {\r\n        localStorage.removeItem(\"usuario_logueado\");\r\n        sessionStorage.removeItem(\"usuario_logueado\");\r\n\r\n        localStorage.removeItem(\"agencia_logueado\");\r\n        sessionStorage.removeItem(\"agencia_logueado\");\r\n\r\n        localStorage.removeItem(\"bd_logueado\");\r\n        sessionStorage.removeItem(\"bd_logueado\");\r\n\r\n        localStorage.removeItem(\"user_conn\");\r\n        sessionStorage.removeItem(\"user_conn\");\r\n\r\n        this.eliminarToken();\r\n        localStorage.removeItem(\"token\");\r\n        sessionStorage.removeItem(\"token\");\r\n\r\n        return this.router.navigate(['/login']);\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}